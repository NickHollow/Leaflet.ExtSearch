{"version":3,"file":"main.js","sources":["../node_modules/scanex-event-target/dist/scanex-event-target.cjs.js","../src/ResultView.js","../src/SearchWidget.js","../src/SearchControl.js","../src/DataProviders/OsmDataProvider.js","../src/DataProviders/CoordinatesDataProvider.js","../src/DataProviders/CadastreDataProvider.js"],"sourcesContent":["'use strict';\r\n\r\nvar classCallCheck = function (instance, Constructor) {\r\n  if (!(instance instanceof Constructor)) {\r\n    throw new TypeError(\"Cannot call a class as a function\");\r\n  }\r\n};\r\n\r\nvar createClass = function () {\r\n  function defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n      var descriptor = props[i];\r\n      descriptor.enumerable = descriptor.enumerable || false;\r\n      descriptor.configurable = true;\r\n      if (\"value\" in descriptor) descriptor.writable = true;\r\n      Object.defineProperty(target, descriptor.key, descriptor);\r\n    }\r\n  }\r\n\r\n  return function (Constructor, protoProps, staticProps) {\r\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\r\n    if (staticProps) defineProperties(Constructor, staticProps);\r\n    return Constructor;\r\n  };\r\n}();\r\n\r\nvar EventTarget = function () {\r\n    function EventTarget() {\r\n        classCallCheck(this, EventTarget);\r\n\r\n        this.listeners = {};\r\n    }\r\n\r\n    createClass(EventTarget, [{\r\n        key: 'addEventListener',\r\n        value: function addEventListener(type, callback) {\r\n            if (!(type in this.listeners)) {\r\n                this.listeners[type] = [];\r\n            }\r\n            this.listeners[type].push(callback);\r\n        }\r\n    }, {\r\n        key: 'on',\r\n        value: function on(type, callback) {\r\n            this.addEventListener(type, callback);\r\n            return this;\r\n        }\r\n    }, {\r\n        key: 'removeEventListener',\r\n        value: function removeEventListener(type, callback) {\r\n            if (!(type in this.listeners)) {\r\n                return;\r\n            }\r\n            var stack = this.listeners[type];\r\n            for (var i = 0, l = stack.length; i < l; i++) {\r\n                if (stack[i] === callback) {\r\n                    stack.splice(i, 1);\r\n                    return this.removeEventListener(type, callback);\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: 'off',\r\n        value: function off(type, callback) {\r\n            this.removeEventListener(type, callback);\r\n            return this;\r\n        }\r\n    }, {\r\n        key: 'dispatchEvent',\r\n        value: function dispatchEvent(event) {\r\n            if (!(event.type in this.listeners)) {\r\n                return;\r\n            }\r\n            var stack = this.listeners[event.type];\r\n            Object.defineProperty(event, 'target', {\r\n                enumerable: false,\r\n                configurable: false,\r\n                writable: false,\r\n                value: this\r\n            });\r\n            for (var i = 0, l = stack.length; i < l; i++) {\r\n                stack[i].call(this, event);\r\n            }\r\n        }\r\n    }]);\r\n    return EventTarget;\r\n}();\r\n\r\nmodule.exports = EventTarget;\r\n","import EventTarget from 'scanex-event-target';\r\n\r\nclass ResultView extends EventTarget {\r\n    constructor({input, replaceInput = false}){\r\n        super();\r\n        this._input = input;            \r\n        this.index = -1;\r\n        this.count = 0;\r\n        this._item = null;\r\n        this._inputText = '';\r\n        this._replaceInput = replaceInput;\r\n        this._list = L.DomUtil.create('div');\r\n        this._list.setAttribute('class', 'leaflet-ext-search-list noselect');\r\n\r\n        this.allowNavigation = true;\r\n\r\n        this._list.style.top = `${this._input.offsetTop + this._input.offsetHeight + 2}px`;\r\n        this._list.style.left = `${this._input.offsetLeft}px`;\r\n\r\n        this._handleKey = this._handleKey.bind(this);\r\n        this._input.addEventListener('keydown', this._handleKey);\r\n\r\n        this._handleInputClick = this._handleInputClick.bind(this);\r\n        this._input.addEventListener('click', this._handleInputClick);\r\n\r\n        this._handleFocus = this._handleFocus.bind(this);\r\n        this._input.addEventListener('focus', this._handleFocus);\r\n        this._list.addEventListener('keydown', this._handleKey);\r\n\r\n        this._handleWheel = this._handleWheel.bind(this);\r\n        this._list.addEventListener('wheel', this._handleWheel);\r\n        L.DomEvent.disableClickPropagation(this._list).disableScrollPropagation(this._list);\r\n        // this._list.addEventListener('mousewheel', this._handleWheel.bind(this));\r\n        // this._list.addEventListener('MozMousePixelScroll', this._handleWheel.bind(this));       \r\n        this._input.parentElement.appendChild(this._list); \r\n\r\n        this._handleChange = this._handleChange.bind(this);\r\n        this._input.addEventListener('input', this._handleChange);\r\n    }\r\n\r\n    _handleInputClick (e) {\r\n        e.stopPropagation();\r\n    }\r\n\r\n    _handleFocus(e){        \r\n        if(this.index >= 0) {\r\n            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`); \r\n            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\r\n        }\r\n        this.index = -1;\r\n        this._item = null;\r\n    } \r\n\r\n    _handleChange(e){\r\n        this._inputText = this._input.value;\r\n    }\r\n\r\n    _handleWheel (e) {\r\n        e.stopPropagation();        \r\n    } \r\n\r\n    _handleKey(e){        \r\n        if(this.listVisible()) {\r\n            switch (e.keyCode){\r\n                // ArroLeft / ArrowRight\r\n                case 37:\r\n                case 39:\r\n                    e.stopPropagation();\r\n                    break;\r\n                // ArrowDown\r\n                case 40:\r\n                    e.preventDefault();\r\n                    e.stopPropagation();                 \r\n                    if (this.allowNavigation) {                        \r\n                        if (this.index < 0){\r\n                            this.index = 0;\r\n                        }\r\n                        else if (0 <= this.index && this.index < this.count - 1){\r\n                            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\r\n                            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\r\n                            ++this.index;\r\n                        }   \r\n                        else {\r\n                            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\r\n                            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\r\n                            this.index = this.count - 1;\r\n                        }\r\n                        let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\r\n                        L.DomUtil.addClass (el, 'leaflet-ext-search-list-selected'); \r\n                        this.selectItem(this.index);\r\n                        el.focus();\r\n                    }\r\n                    break;\r\n                // ArrowUp\r\n                case 38:\r\n                    e.preventDefault(); \r\n                    e.stopPropagation(); \r\n                    if (this.allowNavigation) {\r\n                        if(this.index > 0){\r\n                            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`); \r\n                            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\r\n                            --this.index;\r\n                            el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\r\n                            L.DomUtil.addClass (el, 'leaflet-ext-search-list-selected');\r\n                            this.selectItem(this.index);\r\n                            el.focus();            \r\n                        }\r\n                        else if (this.index === 0) {                    \r\n                            this._input.focus();                \r\n                            this._input.value = this._inputText;                    \r\n                        }\r\n                    }\r\n                    break;\r\n                // Enter\r\n                case 13:\r\n                    if (this.index < 0 && this._input.value){\r\n                        const text = this._input.value;\r\n                        this._input.focus();\r\n                        this._input.setSelectionRange(text.length, text.length);                                      \r\n                        this.hide();\r\n                        \r\n                        let event = document.createEvent('Event');\r\n                        event.initEvent('suggestions:confirm', false, false);\r\n                        event.detail = text;\r\n                        this.dispatchEvent(event);\r\n                    }\r\n                    else {\r\n                        this.complete (this.index);\r\n                    }                   \r\n                    break;\r\n                // Escape\r\n                case 27:\r\n                    if (this.index < 0) {\r\n                        this.hide ();\r\n                    }\r\n                    this._input.focus();\r\n                    this._input.value = this._inputText;\r\n                    break;                 \r\n                default:\r\n                    break;\r\n            }            \r\n        }\r\n        else {            \r\n            if (e.keyCode === 13 && this._input.value){ \r\n                const text = this._input.value;\r\n                this._input.setSelectionRange(text.length, text.length);\r\n\r\n                let event = document.createEvent('Event');\r\n                event.initEvent('suggestions:confirm', false, false);\r\n                event.detail = text;\r\n                this.dispatchEvent(event);                \r\n            }\r\n            else if (e.keyCode === 27){\r\n                this._input.value = '';\r\n                this.index = -1;\r\n                this._input.focus();                \r\n            }\r\n        } \r\n                                                                    \r\n    }\r\n\r\n    listVisible(){\r\n        return this.count > 0 && this._list.style.display !== 'none';\r\n    }\r\n\r\n    selectItem(i){        \r\n        this._item = this._items[i];        \r\n        const text = this._item.name;\r\n        if (this._replaceInput) {\r\n            this._input.value = text;            \r\n            this._input.setSelectionRange(text.length, text.length);\r\n        }        \r\n    }\r\n\r\n    _handleClick (i, e){\r\n        e.preventDefault();\r\n        this.complete (i);\r\n    }\r\n\r\n    complete(i){\r\n        let item = i >= 0 ? this._items[i] : this._item ? this._item : null;\r\n        if(item) {\r\n            this._item = item;        \r\n            this.index = -1;            \r\n            const text = item.name;\r\n            if (this._replaceInput) {\r\n                this._input.value = text;\r\n                this._input.setSelectionRange(text.length, text.length);\r\n            }\r\n            this._input.focus();\r\n            this.hide();\r\n\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('suggestions:select', false, false);\r\n            event.detail = item;\r\n            this.dispatchEvent(event);            \r\n        }        \r\n    }\r\n\r\n    show(items, highlight) {        \r\n        if (items.length) {\r\n            this._item = null;\r\n            this.index = -1;\r\n            this._items = items;\r\n            const html = '<ul>' + this._items\r\n            .filter((x) => x.name && x.name.length)\r\n            .map((x,i) => {\r\n                let name = `<span class=\"leaflet-ext-search-list-item-normal\">${x.name}</span>`;\r\n                if (highlight && highlight.length){\r\n                    const start = x.name.toLowerCase().indexOf (highlight.toLowerCase());\r\n                    if (start != -1) {\r\n                        let head =  x.name.substr(0, start);\r\n                        if(head.length){\r\n                            head = `<span class=\"leaflet-ext-search-list-item-normal\">${head}</span>`;\r\n                        }                        \r\n                        let tail = x.name.substr(start + highlight.length);\r\n                        if(tail.length){\r\n                            tail = `<span class=\"leaflet-ext-search-list-item-normal\">${tail}</span>`;\r\n                        }\r\n                        name = `${head}<span class=\"leaflet-ext-search-list-item-highlight\">${highlight}</span>${tail}`;\r\n                    }                                        \r\n                }                \r\n                return `<li tabindex=${i}>${name}</li>`;               \r\n            }, []).join('') + '</ul>';\r\n\r\n            this._list.innerHTML = html;\r\n            let elements = this._list.querySelectorAll('li');\r\n            for (let i = 0; i < elements.length; ++i){\r\n                elements[i].addEventListener('click', this._handleClick.bind(this, i));            \r\n            }\r\n            \r\n            this.count = elements.length;\r\n            this._list.style.display = 'block';\r\n        }\r\n    }\r\n    hide() {        \r\n        this._list.style.display = 'none';                \r\n    }\r\n}\r\n\r\nexport default ResultView;","import './SearchWidget.css';\r\nimport ResultView from './ResultView.js';\r\nimport EventTarget from 'scanex-event-target';\r\n\r\nfunction chain (tasks, state) {\r\n    return tasks.reduce(\r\n        (prev, next) => prev.then(next),\r\n        new Promise ((resolve, reject) => resolve (state))\r\n    );\r\n}\r\n\r\nclass SearchWidget extends EventTarget {\r\n    constructor(container, {placeHolder, providers, suggestionTimeout = 1000, suggestionLimit = 10, fuzzySearchLimit = 1000, retrieveManyOnEnter = false, replaceInputOnEnter = false}){\r\n        super ();\r\n        this._container = container;\r\n        this._allowSuggestion = true;\r\n        this._providers = providers;\r\n        this._suggestionTimeout = suggestionTimeout;\r\n        this._suggestionLimit = suggestionLimit;\r\n        this._fuzzySearchLimit = fuzzySearchLimit;\r\n        this._retrieveManyOnEnter = retrieveManyOnEnter;\r\n        this._replaceInputOnEnter = replaceInputOnEnter;\r\n\r\n        this._container.classList.add('leaflet-ext-search');\r\n        this._container.innerHTML = `<input type=\"text\" value=\"\" placeholder=\"${placeHolder}\" /><span class=\"leaflet-ext-search-button\"></span>`;\r\n        this._input = this._container.querySelector('input');\r\n\r\n        this._handleChange = this._handleChange.bind(this);\r\n        this._input.addEventListener('input', this._handleChange);\r\n\r\n        this._handleMouseMove = this._handleMouseMove.bind(this);\r\n        this._input.addEventListener('mousemove', this._handleMouseMove);        \r\n        this._input.addEventListener('dragstart', this._handleMouseMove);\r\n        this._input.addEventListener('drag', this._handleMouseMove);\r\n\r\n        this._handleSearch = this._handleSearch.bind(this);\r\n\r\n        this._button = this._container.querySelector('.leaflet-ext-search-button');\r\n        this._button.addEventListener('click', this._handleSearch);\r\n\r\n        this.results = new ResultView({ input: this._input, replaceInput: this._replaceInputOnEnter});\r\n\r\n        this._search = this._search.bind(this);\r\n        this._selectItem = this._selectItem.bind(this);\r\n\r\n        this.results.addEventListener('suggestions:confirm', e => {\r\n            let event = document.createEvent('Event');\r\n            event.initEvent('suggestions:confirm', false, false);\r\n            event.detail = e.detail;\r\n            this.dispatchEvent(event);\r\n            this._search(e);                        \r\n        });\r\n        this.results.addEventListener('suggestions:select', this._selectItem);\r\n\r\n        // map.on ('click', this.results.hide.bind(this.results));\r\n        // map.on ('dragstart', this.results.hide.bind(this.results));\r\n    }\r\n    _suggest (text){\r\n        this.results.allowNavigation = false;\r\n        let tasks =\r\n            this._providers\r\n            .filter (provider => provider.showSuggestion)\r\n            .map(provider => {\r\n                return state => {\r\n                    return new Promise(resolve => {\r\n                        if (state.completed) {\r\n                            resolve(state);\r\n                        }\r\n                        else {\r\n                            provider\r\n                            .find (text, this._suggestionLimit, false, false)\r\n                            .then(response => {\r\n                                state.completed = response.length > 0;\r\n                                state.response = state.response.concat(response);\r\n                                resolve(state);\r\n                            })\r\n                            .catch(e => console.log(e));\r\n                        }\r\n                    });\r\n                };\r\n            });\r\n        chain (tasks, { completed: false, response: [] })\r\n        .then(state => {\r\n            this.results.show(state.response, text.trim());\r\n            this.results.allowNavigation = true;\r\n        });\r\n    }\r\n    _handleChange(e) {\r\n        if (this._input.value.length) {\r\n            if (this._allowSuggestion) {\r\n                this._allowSuggestion = false;\r\n                this._timer = setTimeout(() => {\r\n                    clearTimeout (this._timer);\r\n                    this._allowSuggestion = true;\r\n                    const text = this._input.value;\r\n                    this._suggest(text);\r\n                }, this._suggestionTimeout);\r\n            }\r\n        }\r\n        else {\r\n            this.results.hide();\r\n        }\r\n    }\r\n    _handleMouseMove(e){\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n    }\r\n    _search (e) {\r\n        let text = e.detail;\r\n        let tasks = this._providers\r\n            .filter (provider => provider.showOnEnter)\r\n            .map(provider => {\r\n                return state => {\r\n                    return new Promise(resolve => {\r\n                        if (state.completed) {\r\n                            resolve(state);\r\n                        }\r\n                        else {\r\n                            provider\r\n                            .find (text, this._retrieveManyOnEnter ? this._fuzzySearchLimit : 1, true, true)\r\n                            .then(response => {\r\n                                state.completed = response.length > 0;\r\n                                state.response = state.response.concat(response);\r\n                                resolve(state);\r\n                            })\r\n                            .catch(e => {\r\n                                console.log(e);\r\n                                resolve(state);\r\n                            });\r\n                        }\r\n                    });\r\n                };\r\n            });\r\n\r\n            chain (tasks, {completed: false, response: []})\r\n            .then(state => {                \r\n                // if(state.response.length > 0 && !this._retrieveManyOnEnter){\r\n                //     let item = state.response[0];\r\n                //     item.provider\r\n                //     .fetch(item.properties)\r\n                //     .then(response => {});                    \r\n                // }\r\n            });\r\n\r\n            this.results && this.results.hide();\r\n    }\r\n    _selectItem (e){\r\n        let item = e.detail;\r\n        return item.provider.fetch(item.properties);\r\n    }\r\n    _handleSearch (e) {\r\n         e.stopPropagation();\r\n         this._search ({detail: this._input.value});\r\n    }\r\n    setText (text) {\r\n        this._input.value = text;\r\n    }\r\n    setPlaceHolder (value) {\r\n        this._input.placeholder = value;\r\n    }\r\n}\r\n\r\nexport default SearchWidget;\r\n","import SearchWidget from './SearchWidget.js';\r\n\r\nlet SearchControl = L.Control.extend({\r\n    includes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\r\n    initialize: function(options) {\r\n        L.setOptions(this, options);\r\n        this._allowSuggestion = true;\r\n        this.options.suggestionTimeout = this.options.suggestionTimeout || 1000;\r\n        this.options.suggestionLimit = this.options.suggestionLimit || 10;\r\n    },\r\n    onAdd: function(map) {\r\n        this._container = L.DomUtil.create('div', 'leaflet-ext-search');\r\n        this._widget = new SearchWidget(this._container, this.options);\r\n        map.on('click', this._widget.results.hide.bind(this._widget.results));\r\n        map.on('dragstart', this._widget.results.hide.bind(this._widget.results));        \r\n        return this._container;\r\n    },\r\n    addTo: function(map) {\r\n        L.Control.prototype.addTo.call(this, map);\r\n        if (this.options.addBefore) {\r\n            this.addBefore(this.options.addBefore);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    addBefore: function(id) {\r\n        let parentNode = this._parent && this._parent._container;\r\n        if (!parentNode) {\r\n            parentNode = this._map && this._map._controlCorners[this.getPosition()];\r\n        }\r\n        if (!parentNode) {\r\n            this.options.addBefore = id;\r\n        }\r\n        else {\r\n            for (let i = 0, len = parentNode.childNodes.length; i < len; i++) {\r\n                let it = parentNode.childNodes[i];\r\n                if (id === it._id) {\r\n                    parentNode.insertBefore(this._container, it);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    },\r\n\r\n    setText (text) {\r\n        this._widget.setText (text);\r\n    },\r\n\r\n    setPlaceHolder (value) {\r\n        this._widget.setPlaceHolder (value);\r\n    },\r\n});\r\n\r\nexport default SearchControl;","\r\nimport EventTarget from 'scanex-event-target';\r\n\r\nclass OsmDataProvider extends EventTarget {\r\n    constructor({serverBase}){\r\n        super();\r\n        this._serverBase = serverBase;             \r\n        this.showSuggestion = true;    \r\n        this.showOnSelect = true;\r\n        this.showOnEnter = true;\r\n        this.find = this.find.bind(this);\r\n        this.fetch = this.fetch.bind(this);\r\n        this._convertGeometry = this._convertGeometry.bind(this);\r\n\r\n        this._key = window.KOSMOSNIMKI_SESSION_KEY == null || window.KOSMOSNIMKI_SESSION_KEY == 'INVALID' ? '' : `&key=${window.KOSMOSNIMKI_SESSION_KEY}`;\r\n    }\r\n    _convertGeometry(geometry) {        \r\n        switch (geometry.type.toUpperCase()) {\r\n            case 'POINT':\r\n                geometry.type = 'Point';\r\n                break;\r\n            case 'POLYGON':\r\n                geometry.type = 'Polygon';\r\n                break;\r\n            case 'MULTIPOLYGON':\r\n                geometry.type = 'MultiPolygon';\r\n                break;\r\n            case 'LINESTRING':\r\n            case 'POLYLINE':\r\n                geometry.type = 'LineString';\r\n                break;\r\n            case 'MULTILINESTRING':\r\n                geometry.type = 'MultiLineString';\r\n                break;\r\n            default:\r\n                throw 'Unknown WKT type';\r\n        }\r\n        return geometry;\r\n    }\r\n    fetch (obj) {\r\n        const query = `WrapStyle=None&RequestType=ID&ID=${obj.ObjCode}&TypeCode=${obj.TypeCode}&UseOSM=1`;        \r\n        let req = new Request(`${this._serverBase}/SearchObject/SearchAddress.ashx?${query}${this._key}`);\r\n        let headers = new Headers();\r\n        headers.append('Content-Type','application/json');        \r\n        let init = {\r\n            method: 'GET',            \r\n            mode: 'cors',\r\n            credentials: 'include',        \r\n            cache: 'default',\r\n        };\r\n        return new Promise((resolve, reject) => {\r\n            fetch (req, init)\r\n            .then(response => response.json())\r\n            .then(json => {\r\n                if(json.Status === 'ok'){\r\n                    const rs = json.Result\r\n                    .reduce((a,x) => a.concat(x.SearchResult), [])\r\n                    .map(x => {\r\n                        let g = this._convertGeometry (x.Geometry);\r\n                        let props = Object.keys(x)\r\n                        .filter(k => k !== 'Geometry')\r\n                        .reduce((a,k) => {\r\n                            a[k] = x[k];\r\n                            return a;\r\n                        }, {});\r\n                        return {\r\n                            feature: {\r\n                                type: 'Feature',\r\n                                geometry: g,\r\n                                properties: props,                            \r\n                            },\r\n                            provider: this,\r\n                            query: obj,\r\n                        };\r\n                    });\r\n                    let event = document.createEvent('Event');\r\n                    event.initEvent('fetch', false, false);\r\n                    event.detail = rs;\r\n                    this.dispatchEvent(event);\r\n                    resolve(rs);\r\n                }\r\n                else {\r\n                    reject(json);\r\n                }                \r\n            })\r\n            .catch(response => reject(response));\r\n        });\r\n    }\r\n    find(value, limit, strong, retrieveGeometry){                \r\n        return new Promise((resolve, reject) => {\r\n            if (value || value.trim()) {\r\n                const _strong = Boolean(strong) ? 1 : 0;\r\n                const _withoutGeometry = Boolean(retrieveGeometry) ? 0 : 1; \r\n                const query = `WrapStyle=None&RequestType=SearchObject&IsStrongSearch=${_strong}&WithoutGeometry=${_withoutGeometry}&UseOSM=1&Limit=${limit}&SearchString=${encodeURIComponent(value)}`;        \r\n                let req = new Request(`${this._serverBase}/SearchObject/SearchAddress.ashx?${query}${this._key}`);\r\n                let headers = new Headers();\r\n                headers.append('Content-Type','application/json');        \r\n                let init = {\r\n                    method: 'GET',\r\n                    mode: 'cors', \r\n                    credentials: 'include',\r\n                    cache: 'default',\r\n                };\r\n                fetch (req, init)\r\n                .then(response => response.json())\r\n                .then(json => {                \r\n                    if(json.Status === 'ok'){                    \r\n                        const rs = json.Result\r\n                        .reduce((a,x) => a.concat(x.SearchResult), [])\r\n                        .map(x => {\r\n                            if (retrieveGeometry && x.Geometry) {\r\n                                let g = this._convertGeometry (x.Geometry);\r\n                                let props = Object.keys(x)\r\n                                .filter(k => k !== 'Geometry')\r\n                                .reduce((a,k) => {\r\n                                    a[k] = x[k];\r\n                                    return a;\r\n                                }, {});\r\n                                return {\r\n                                    name: x.ObjNameShort,\r\n                                    feature: {\r\n                                        type: 'Feature',\r\n                                        geometry: g,\r\n                                        properties: props,                            \r\n                                    },\r\n                                    properties: props,\r\n                                    provider: this,\r\n                                    query: value,\r\n                                };\r\n                            }\r\n                            else {\r\n                                return {\r\n                                    name: x.ObjNameShort,\r\n                                    properties: x,\r\n                                    provider: this,\r\n                                    query: value,\r\n                                };\r\n                            }                        \r\n                        });\r\n                        if (strong && retrieveGeometry) {                        \r\n                            let event = document.createEvent('Event');\r\n                            event.initEvent('fetch', false, false);\r\n                            event.detail = rs;\r\n                            this.dispatchEvent(event);\r\n                        }\r\n                        resolve(rs);\r\n                    }\r\n                    else {\r\n                        reject(json);\r\n                    }                \r\n                })\r\n                .catch(response => reject(response));\r\n\r\n            }\r\n            else {\r\n                reject('Empty string');\r\n            }                        \r\n        });\r\n    }\r\n}\r\n\r\nexport default OsmDataProvider;","import EventTarget from 'scanex-event-target';\r\n\r\nclass CoordinatesDataProvider extends EventTarget {\r\n    constructor(){\r\n        super();        \r\n        this.showSuggestion = false;        \r\n        this.showOnSelect = false;\r\n        this.showOnEnter = true;\r\n        this.fetch = this.fetch.bind(this);\r\n        this.find = this.find.bind(this);        \r\n\r\n        this.rxF = new RegExp('^\\\\s*\\\\-?(\\\\d+(\\\\.\\\\d+)?)(\\\\s+[N|S])?(,\\\\s*|\\\\s+)\\\\-?(\\\\d+(\\\\.\\\\d+)?)(\\\\s+[E|W])?');\r\n        this.rxD = new RegExp('^\\\\s*(\\\\d{1,2})[\\\\s|\\\\u00b0](\\\\d{1,2})[\\\\s|\\\\u0027](\\\\d{1,2}\\\\.\\\\d+)\\\\u0022?(\\\\s+[N|S])?,?\\\\s+(\\\\d{1,2})[\\\\s|\\\\u00b0](\\\\d{1,2})[\\\\s|\\\\u0027](\\\\d{1,2}\\\\.\\\\d+)\\\\u0022?(\\\\s+[E|W])?');\r\n    }\r\n    _parseCoordinates(value) {\r\n        let m = this.rxD.exec(value);\r\n        if (Array.isArray(m) && m.length === 9) {\r\n            return this._parseDegrees ([m[1],m[2],m[3],m[5],m[6],m[7]].map(x => parseFloat(x)));\r\n        }\r\n        m = this.rxF.exec(value);\r\n        if (Array.isArray (m) && m.length === 8){\r\n            return {type: 'Point', coordinates: [\r\n                parseFloat(m[5]),\r\n                parseFloat(m[1])\r\n            ]};\r\n        }\r\n        \r\n        return null;               \r\n    }\r\n    _parseDegrees ([latDeg, latMin, latSec, lngDeg, lngMin, lngSec]) {    \r\n        return {type: 'Point', coordinates: [\r\n            lngDeg + lngMin / 60 + lngSec / 3600,\r\n            latDeg + latMin / 60 + latSec / 3600\r\n        ]};\r\n    }\r\n    fetch (value){\r\n        return new Promise(resolve => resolve([]));\r\n    }\r\n    find(value, limit, strong, retrieveGeometry){        \r\n        let g = this._parseCoordinates(value);        \r\n        return new Promise(resolve => {\r\n            let result = {feature: { type: 'Feature', geometry: g, properties: {} }, provider: this, query: value};\r\n            if (g) {\r\n                let event = document.createEvent('Event');\r\n                event.initEvent('fetch', false, false);\r\n                event.detail = result;\r\n                this.dispatchEvent(event);\r\n            }             \r\n            resolve(g ? [result] : []);\r\n        });\r\n    }\r\n}\r\n\r\nexport default CoordinatesDataProvider;","import EventTarget from 'scanex-event-target';\r\n\r\nclass CadastreDataProvider extends EventTarget {\r\n    constructor({serverBase, tolerance}){\r\n        super();\r\n        this._serverBase = serverBase;        \r\n        this._tolerance = tolerance;        \r\n        this.showSuggestion = true;\r\n        this.showOnSelect = false;\r\n        this.showOnEnter = true;\r\n        this._cadastreLayers = [\r\n\t\t\t{id: 1, title: 'Участок', \treg: /^\\d\\d:\\d+:\\d+:\\d+$/},\r\n\t\t\t{id: 2, title: 'Квартал',\treg: /^\\d\\d:\\d+:\\d+$/},\r\n\t\t\t{id: 3, title: 'Район', \treg: /^\\d\\d:\\d+$/},\r\n\t\t\t{id: 4, title: 'Округ', \treg: /^\\d\\d$/},\r\n            {id: 5, title: 'ОКС', \t\treg: /^\\d\\d:\\d+:\\d+:\\d+:\\d+$/},\r\n\t\t\t{id: 10, title: 'ЗОУИТ', \treg: /^\\d+\\.\\d+\\.\\d+/}\r\n\t\t\t// ,\r\n\t\t\t// {id: 7, title: 'Границы', \treg: /^\\w+$/},\r\n\t\t\t// {id: 6, title: 'Тер.зоны', \treg: /^\\w+$/},\r\n\t\t\t// {id: 12, title: 'Лес', \t\treg: /^\\w+$/},\r\n\t\t\t// {id: 13, title: 'Красные линии', \t\treg: /^\\w+$/},\r\n\t\t\t// {id: 15, title: 'СРЗУ', \treg: /^\\w+$/},\r\n\t\t\t// {id: 16, title: 'ОЭЗ', \t\treg: /^\\w+$/},\r\n\t\t\t// {id: 9, title: 'ГОК', \t\treg: /^\\w+$/},\r\n\t\t\t// {id: 10, title: 'ЗОУИТ', \treg: /^\\w+$/}\r\n\t\t\t// /[^\\d\\:]/g,\r\n\t\t\t// /\\d\\d:\\d+$/,\r\n\t\t\t// /\\d\\d:\\d+:\\d+$/,\r\n\t\t\t// /\\d\\d:\\d+:\\d+:\\d+$/\r\n\t\t];\r\n    }    \r\n    getCadastreLayer (str, type) {\r\n        str = str.trim();\r\n        for (var i = 0, len = this._cadastreLayers.length; i < len; i++) {\r\n            var it = this._cadastreLayers[i];\r\n            if (it.id === type) { return it; }\r\n            if (it.reg.exec(str)) { return it; }\r\n        }\r\n        return this._cadastreLayers[0];\r\n    }\r\n    find(value, limit, strong, retrieveGeometry){   \r\n        const cadastreLayer = this.getCadastreLayer(value);    \r\n        return new Promise(resolve => {\r\n            // let req = new Request(`${this._serverBase}/typeahead?limit=${limit}&skip=0&text=${value}&type=${cadastreLayer.id}`);\r\n            let req = new Request(`${this._serverBase}/features/${cadastreLayer.id}?text=${value}&tolerance=${this._tolerance}&limit=${limit}`);\r\n            let headers = new Headers();\r\n            headers.append('Content-Type','application/json');            \r\n            let init = {\r\n                method: 'GET',            \r\n                mode: 'cors',                \r\n                cache: 'default',\r\n            };\r\n            fetch (req, init)\r\n            .then(response => response.json())\r\n            .then(json => {\r\n                // if(json.status === 200){\r\n                    let rs = json.features.map(x => {\r\n                        return {\r\n                            name: x.attrs.name || x.attrs.cn || x.attrs.id,\r\n                            properties: x,\r\n                            provider: this,\r\n                            query: value,\r\n                        };\r\n                    });\r\n                    resolve(rs);\r\n                // }\r\n                // else {\r\n                    // resolve(json);\r\n                // }                                       \r\n                                    \r\n            });\r\n        });\r\n    }\r\n    fetch(obj) {\r\n\t\tvar text = obj.attrs.name || obj.attrs.cn || obj.attrs.id;\r\n        const cadastreLayer = this.getCadastreLayer(text, obj.type);\r\n        return new Promise(resolve => {\r\n            if(cadastreLayer) {\r\n                // let req = new Request(`${this._serverBase}/features/${cadastreLayer.id}?tolerance=${this._tolerance}&limit=1&text=${obj.value}`);\r\n                let req = new Request(`${this._serverBase}/features/${cadastreLayer.id}?tolerance=${this._tolerance}&limit=1&text=${text}`);\r\n                let headers = new Headers();\r\n                headers.append('Content-Type','application/json');\r\n                let init = {\r\n                    method: 'GET',            \r\n                    mode: 'cors',                    \r\n                    cache: 'default',\r\n                };\r\n                fetch (req, init)\r\n                .then(response => response.json())\r\n                .then(json => {\r\n                    if(json.status === 200) {\r\n                        let event = document.createEvent('Event');\r\n                        event.initEvent('fetch', false, false);\r\n                        event.detail = json;\r\n                        this.dispatchEvent(event);\r\n                        \r\n                        let rs = json.features.map(x => {\r\n                            return {\r\n                                name: x.attrs.name || x.attrs.cn || x.attrs.id,\r\n                                properties: x,\r\n                                provider: this,\r\n                                query: obj,\r\n                            };\r\n                            \r\n                        });\r\n                        resolve(rs);\r\n\r\n                    }\r\n                    else {\r\n                        resolve(json);\r\n                    }                                        \r\n                });\r\n            }\r\n            else {\r\n                resolve([]);\r\n            }            \r\n        });\r\n    }\r\n}\r\n\r\nexport default CadastreDataProvider;"],"names":["ResultView","input","replaceInput","_input","index","count","_item","_inputText","_replaceInput","_list","L","DomUtil","create","setAttribute","allowNavigation","style","top","offsetTop","offsetHeight","left","offsetLeft","_handleKey","bind","addEventListener","_handleInputClick","_handleFocus","_handleWheel","DomEvent","disableClickPropagation","disableScrollPropagation","parentElement","appendChild","_handleChange","e","stopPropagation","el","querySelector","removeClass","value","listVisible","keyCode","preventDefault","addClass","selectItem","focus","text","setSelectionRange","length","hide","event","document","createEvent","initEvent","detail","dispatchEvent","complete","display","i","_items","name","item","items","highlight","html","filter","x","map","start","toLowerCase","indexOf","head","substr","tail","join","innerHTML","elements","querySelectorAll","_handleClick","EventTarget","chain","tasks","state","reduce","prev","next","then","Promise","resolve","reject","SearchWidget","container","placeHolder","providers","suggestionTimeout","suggestionLimit","fuzzySearchLimit","retrieveManyOnEnter","replaceInputOnEnter","_container","_allowSuggestion","_providers","_suggestionTimeout","_suggestionLimit","_fuzzySearchLimit","_retrieveManyOnEnter","_replaceInputOnEnter","classList","add","_handleMouseMove","_handleSearch","_button","results","_search","_selectItem","provider","showSuggestion","completed","find","response","concat","console","log","show","trim","_timer","setTimeout","clearTimeout","_suggest","showOnEnter","fetch","properties","placeholder","SearchControl","Control","extend","includes","Evented","prototype","Mixin","Events","initialize","options","setOptions","onAdd","_widget","on","addTo","call","addBefore","id","parentNode","_parent","_map","_controlCorners","getPosition","len","childNodes","it","_id","insertBefore","setText","setPlaceHolder","OsmDataProvider","serverBase","_serverBase","showOnSelect","_convertGeometry","_key","window","KOSMOSNIMKI_SESSION_KEY","geometry","type","toUpperCase","obj","query","ObjCode","TypeCode","req","Request","headers","Headers","append","init","method","mode","credentials","cache","json","Status","rs","Result","a","SearchResult","g","Geometry","props","Object","keys","k","feature","limit","strong","retrieveGeometry","_strong","Boolean","_withoutGeometry","encodeURIComponent","ObjNameShort","CoordinatesDataProvider","rxF","RegExp","rxD","m","exec","Array","isArray","_parseDegrees","parseFloat","coordinates","latDeg","latMin","latSec","lngDeg","lngMin","lngSec","_parseCoordinates","result","CadastreDataProvider","tolerance","_tolerance","_cadastreLayers","title","reg","str","cadastreLayer","getCadastreLayer","features","attrs","cn","status"],"mappings":"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"}