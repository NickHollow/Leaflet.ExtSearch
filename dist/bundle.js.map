{"version":3,"sources":["webpack:///webpack/bootstrap fca0cc2893ebfad7c144","webpack:///./E:/projects/Leaflet.ExtSearch/src/SearchControl.js","webpack:///./src/SearchControl.css","webpack:///./E:/projects/Leaflet.ExtSearch/src/ResultView.js","webpack:///./E:/projects/Leaflet.ExtSearch/src/DataProviders/OsmDataProvider.js","webpack:///./E:/projects/Leaflet.ExtSearch/src/DataProviders/CoordinatesDataProvider.js","webpack:///./E:/projects/Leaflet.ExtSearch/src/DataProviders/CadastreDataProvider.js"],"names":["SearchControl","L","Control","extend","includes","Mixin","Events","initialize","options","setOptions","_allowSuggestion","suggestionTimeout","limit","_chain","tasks","state","reduce","prev","next","then","Promise","resolve","reject","_suggest","text","results","allowNavigation","providers","filter","provider","showSuggestion","map","completed","find","response","length","concat","catch","console","log","e","show","trim","_handleChange","_input","value","_timer","setTimeout","clearTimeout","hide","_handleMouseMove","stopPropagation","_search","showOnEnter","p","item","fetch","properties","_selectItem","onAdd","_container","DomUtil","create","innerHTML","placeHolder","querySelector","addEventListener","bind","_button","_handleSearch","input","onSelect","onEnter","on","addTo","prototype","call","addBefore","id","parentNode","_parent","_map","_controlCorners","getPosition","i","len","childNodes","it","_id","insertBefore","setText","window","nsGmx","ResultView","replaceInput","_onSelect","_onEnter","index","count","_item","_inputText","_replaceInput","_list","setAttribute","style","top","offsetTop","offsetHeight","left","offsetLeft","_handleKey","_handleInputClick","_handleFocus","_handleWheel","DomEvent","disableClickPropagation","disableScrollPropagation","parentElement","appendChild","el","removeClass","listVisible","keyCode","preventDefault","addClass","selectItem","focus","setSelectionRange","complete","display","_items","name","items","highlight","html","x","start","toLowerCase","indexOf","head","substr","tail","join","elements","querySelectorAll","_handleClick","OsmDataProvider","serverBase","onFetch","_serverBase","_onFetch","showOnSelect","_convertGeometry","_key","KOSMOSNIMKI_SESSION_KEY","geometry","type","toUpperCase","obj","query","ObjCode","TypeCode","req","Request","headers","Headers","append","init","method","mode","credentials","cache","json","JSON","parse","slice","Status","rs","Result","a","SearchResult","g","Geometry","props","Object","keys","k","feature","strong","retrieveGeometry","_strong","Boolean","_withoutGeometry","encodeURIComponent","ObjNameShort","CoordinatesDataProvider","rxF","RegExp","rxD","m","exec","Array","isArray","_parseDegrees","parseFloat","coordinates","latDeg","latMin","latSec","lngDeg","lngMin","lngSec","_parseCoordinates","result","CadastreDataProvider","tolerance","_tolerance","_cadastreLayers","title","reg","str","cadastreLayer","getCadastreLayer","status","features","attrs","cn"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap fca0cc2893ebfad7c144","import './SearchControl.css';\r\nimport { ResultView } from './ResultView.js';\r\nimport { OsmDataProvider } from './DataProviders/OsmDataProvider.js';\r\nimport { CoordinatesDataProvider } from './DataProviders/CoordinatesDataProvider.js';\r\nimport { CadastreDataProvider } from './DataProviders/CadastreDataProvider.js';\r\n\r\nlet SearchControl = L.Control.extend({\r\n    includes: [L.Mixin.Events],\r\n    initialize: function(options) {    \r\n        L.setOptions(this, options);\r\n        this._allowSuggestion = true;\r\n        this.options.suggestionTimeout = this.options.suggestionTimeout || 1000;\r\n        this.options.limit = this.options.limit || 10;\r\n    },\r\n    _chain (tasks, state) {        \r\n        return tasks.reduce(\r\n            (prev, next) => prev.then(next),\r\n            new Promise ((resolve, reject) => resolve (state))\r\n        );\r\n    },\r\n    _suggest: function(text){\r\n        this.results.allowNavigation = false;\r\n        let tasks = \r\n            this.options.providers\r\n            .filter (provider => provider.showSuggestion)\r\n            .map(provider => {\r\n                return state => {\r\n                    return new Promise(resolve => {\r\n                        if (state.completed) {\r\n                            resolve(state);\r\n                        }\r\n                        else {\r\n                            provider\r\n                            .find (text, this.options.limit, false, false)\r\n                            .then(response => {\r\n                                state.completed = response.length > 0;\r\n                                state.response = state.response.concat(response);                              \r\n                                resolve(state);\r\n                            })\r\n                            .catch(e => console.log(e));\r\n                        }\r\n                    });\r\n                };\r\n            });\r\n        this._chain (tasks, { completed: false, response: [] })\r\n        .then(state => {\r\n            this.results.show(state.response, text.trim());\r\n            this.results.allowNavigation = true;\r\n        });\r\n    },   \r\n    _handleChange: function(e){                \r\n        if (this._input.value.length) {\r\n            if (this._allowSuggestion) {\r\n                this._allowSuggestion = false;                \r\n                this._timer = setTimeout(() => {\r\n                    clearTimeout (this._timer);\r\n                    this._allowSuggestion = true;\r\n                    const text = this._input.value;\r\n                    this._suggest(text);\r\n                }, this.options.suggestionTimeout);\r\n            }\r\n        }\r\n        else {\r\n            this.results.hide();\r\n        }\r\n    },\r\n    _handleMouseMove: function(e){\r\n        e.stopPropagation();\r\n    },\r\n    _search: function (text) {\r\n        let tasks = this.options.providers\r\n            .filter (provider => provider.showOnEnter)\r\n            .map(provider => {\r\n                return state => {\r\n                    return new Promise(resolve => {\r\n                        if (state.completed) {\r\n                            resolve(state);\r\n                        }\r\n                        else {\r\n                            let p = provider.find (text, 1, true, true);\r\n                            p.then(response => {\r\n                                state.completed = response.length > 0;\r\n                                state.response = state.response.concat(response);                                \r\n                                resolve(state);\r\n                            });\r\n                        }\r\n                    });\r\n                };\r\n            });\r\n\r\n            this._chain (tasks, {completed: false, response: []})\r\n            .then(state => {                \r\n                if(state.response.length){\r\n                    let item = state.response[0];\r\n                    item.provider\r\n                    .fetch(item.properties)\r\n                    .then(response => {});\r\n                }\r\n            });\r\n    },\r\n    _selectItem: function(item){        \r\n        return item.provider.fetch(item.properties);\r\n    },    \r\n    onAdd: function(map) {\r\n        this._container = L.DomUtil.create('div', 'leaflet-ext-search');\r\n        this._container.innerHTML = `<input type=\"text\" value=\"\" placeholder=\"${this.options.placeHolder}\" /><span class=\"leaflet-ext-search-button\"></span>`;\r\n        this._input = this._container.querySelector('input');\r\n        this._input.addEventListener('input', this._handleChange.bind(this));\r\n        this._input.addEventListener('mousemove', this._handleMouseMove.bind(this));\r\n        this._input.addEventListener('dragstart', this._handleMouseMove.bind(this));\r\n        this._input.addEventListener('drag', this._handleMouseMove.bind(this));\r\n\r\n        this._button = this._container.querySelector('.leaflet-ext-search-button');\r\n        this._button.addEventListener('click', this._handleSearch.bind(this));\r\n\r\n        this.results = new ResultView({\r\n            input: this._input,\r\n            onSelect: this._selectItem.bind(this),\r\n            onEnter: this._search.bind(this),\r\n        });        \r\n\r\n        map.on ('click', this.results.hide.bind(this.results));\r\n        map.on ('dragstart', this.results.hide.bind(this.results));\r\n        return this._container;\r\n    },\r\n\r\n    _handleSearch: function (e) {\r\n         e.stopPropagation();\r\n         this._search (this._input.value);\r\n    },\r\n\r\n    addTo: function (map) {\r\n        L.Control.prototype.addTo.call(this, map);\r\n        if (this.options.addBefore) {\r\n            this.addBefore(this.options.addBefore);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    addBefore: function (id) {\r\n        var parentNode = this._parent && this._parent._container;\r\n        if (!parentNode) {\r\n            parentNode = this._map && this._map._controlCorners[this.getPosition()];\r\n        }\r\n        if (!parentNode) {\r\n            this.options.addBefore = id;\r\n        } else {\r\n            for (var i = 0, len = parentNode.childNodes.length; i < len; i++) {\r\n                var it = parentNode.childNodes[i];\r\n                if (id === it._id) {\r\n                    parentNode.insertBefore(this._container, it);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    setText: function (text) {\r\n        this._input.value = text;\r\n    }\r\n\r\n});\r\n\r\nwindow.nsGmx = window.nsGmx || {};\r\nwindow.nsGmx.SearchControl = SearchControl; \r\n\r\nexport { SearchControl };\r\n\n\n\n// WEBPACK FOOTER //\n// ./E:/projects/Leaflet.ExtSearch/src/SearchControl.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/SearchControl.css\n// module id = 1\n// module chunks = 0","class ResultView {\r\n    constructor({input, onSelect, onEnter, replaceInput = false}){\r\n        this._input = input;\r\n        this._onSelect = onSelect;\r\n        this._onEnter = onEnter;\r\n        this.index = -1;\r\n        this.count = 0;\r\n        this._item = null;\r\n        this._inputText = '';\r\n        this._replaceInput = replaceInput;\r\n        this._list = L.DomUtil.create('div');\r\n        this._list.setAttribute('class', 'leaflet-ext-search-list noselect');\r\n\r\n        this.allowNavigation = true;\r\n\r\n        this._list.style.top = `${this._input.offsetTop + this._input.offsetHeight + 2}px`;\r\n        this._list.style.left = `${this._input.offsetLeft}px`;\r\n        this._input.addEventListener('keydown', this._handleKey.bind(this));\r\n        this._input.addEventListener('click', this._handleInputClick.bind(this));\r\n        this._input.addEventListener('focus', this._handleFocus.bind(this));\r\n        this._list.addEventListener('keydown', this._handleKey.bind(this));\r\n        this._list.addEventListener('wheel', this._handleWheel.bind(this));\r\n        L.DomEvent.disableClickPropagation(this._list).disableScrollPropagation(this._list);\r\n        // this._list.addEventListener('mousewheel', this._handleWheel.bind(this));\r\n        // this._list.addEventListener('MozMousePixelScroll', this._handleWheel.bind(this));       \r\n        this._input.parentElement.appendChild(this._list); \r\n        this._input.addEventListener('input', this._handleChange.bind(this));\r\n    }\r\n\r\n    _handleInputClick (e) {\r\n        e.stopPropagation();\r\n    }\r\n\r\n    _handleFocus(e){        \r\n        if(this.index >= 0) {\r\n            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`); \r\n            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\r\n        }\r\n        this.index = -1;\r\n        this._item = null;\r\n    } \r\n\r\n    _handleChange(e){\r\n        this._inputText = this._input.value;\r\n    }\r\n\r\n    _handleWheel (e) {\r\n        e.stopPropagation();        \r\n    } \r\n\r\n    _handleKey(e){        \r\n        if(this.listVisible()) {\r\n            switch (e.keyCode){\r\n                // ArroLeft / ArrowRight\r\n                case 37:\r\n                case 39:\r\n                    e.stopPropagation();\r\n                    break;\r\n                // ArrowDown\r\n                case 40:\r\n                    e.preventDefault();\r\n                    e.stopPropagation();                 \r\n                    if (this.allowNavigation) {                        \r\n                        if (this.index < 0){\r\n                            this.index = 0;\r\n                        }\r\n                        else if (0 <= this.index && this.index < this.count - 1){\r\n                            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\r\n                            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\r\n                            ++this.index;\r\n                        }   \r\n                        else {\r\n                            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\r\n                            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\r\n                            this.index = this.count - 1;\r\n                        }\r\n                        let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\r\n                        L.DomUtil.addClass (el, 'leaflet-ext-search-list-selected'); \r\n                        this.selectItem(this.index);\r\n                        el.focus();\r\n                    }\r\n                    break;\r\n                // ArrowUp\r\n                case 38:\r\n                    e.preventDefault(); \r\n                    e.stopPropagation(); \r\n                    if (this.allowNavigation) {\r\n                        if(this.index > 0){\r\n                            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`); \r\n                            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\r\n                            --this.index;\r\n                            el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\r\n                            L.DomUtil.addClass (el, 'leaflet-ext-search-list-selected');\r\n                            this.selectItem(this.index);\r\n                            el.focus();            \r\n                        }\r\n                        else if (this.index === 0) {                    \r\n                            this._input.focus();                \r\n                            this._input.value = this._inputText;                    \r\n                        }\r\n                    }\r\n                    break;\r\n                // Enter\r\n                case 13:\r\n                    if (this.index < 0 && this._input.value && typeof this._onEnter === 'function'){\r\n                        const text = this._input.value;\r\n                        this._input.focus();\r\n                        this._input.setSelectionRange(text.length, text.length);                                      \r\n                        this.hide();                        \r\n                        this._onEnter (text);\r\n                    }\r\n                    else {\r\n                        this.complete (this.index);\r\n                    }                   \r\n                    break;\r\n                // Escape\r\n                case 27:\r\n                    if (this.index < 0) {\r\n                        this.hide ();\r\n                    }\r\n                    this._input.focus();\r\n                    this._input.value = this._inputText;\r\n                    break;                 \r\n                default:\r\n                    break;\r\n            }            \r\n        }\r\n        else {            \r\n            if (e.keyCode === 13 && this._input.value && typeof this._onEnter == 'function'){ \r\n                const text = this._input.value;\r\n                this._input.setSelectionRange(text.length, text.length);\r\n                this._onEnter (text);\r\n            }\r\n            else if (e.keyCode === 27){\r\n                this._input.value = '';\r\n                this.index = -1;\r\n                this._input.focus();                \r\n            }\r\n        } \r\n                                                                    \r\n    }\r\n\r\n    listVisible(){\r\n        return this.count > 0 && this._list.style.display !== 'none';\r\n    }\r\n\r\n    selectItem(i){        \r\n        this._item = this._items[i];        \r\n        const text = this._item.name;\r\n        if (this._replaceInput) {\r\n            this._input.value = text;            \r\n            this._input.setSelectionRange(text.length, text.length);\r\n        }        \r\n    }\r\n\r\n    _handleClick (i, e){\r\n        e.preventDefault();\r\n        this.complete (i);\r\n    }\r\n\r\n    complete(i){\r\n        let item = i >= 0 ? this._items[i] : this._item ? this._item : null;\r\n        if(item) {\r\n            this._item = item;        \r\n            this.index = -1;            \r\n            const text = item.name;\r\n            if (this._replaceInput) {\r\n                this._input.value = text;\r\n                this._input.setSelectionRange(text.length, text.length);\r\n            }\r\n            this._input.focus();\r\n            this.hide();\r\n            if(typeof this._onSelect === 'function'){\r\n                this._onSelect (item);\r\n            }\r\n        }        \r\n    }\r\n\r\n    show(items, highlight) {        \r\n        if (items.length) {\r\n            this._item = null;\r\n            this.index = -1;\r\n            this._items = items;\r\n            const html = '<ul>' + this._items\r\n            .filter((x) => x.name && x.name.length)\r\n            .map((x,i) => {\r\n                let name = `<span class=\"leaflet-ext-search-list-item-normal\">${x.name}</span>`;\r\n                if (highlight && highlight.length){\r\n                    const start = x.name.toLowerCase().indexOf (highlight.toLowerCase());\r\n                    if (start != -1) {\r\n                        let head =  x.name.substr(0, start);\r\n                        if(head.length){\r\n                            head = `<span class=\"leaflet-ext-search-list-item-normal\">${head}</span>`;\r\n                        }                        \r\n                        let tail = x.name.substr(start + highlight.length);\r\n                        if(tail.length){\r\n                            tail = `<span class=\"leaflet-ext-search-list-item-normal\">${tail}</span>`;\r\n                        }\r\n                        name = `${head}<span class=\"leaflet-ext-search-list-item-highlight\">${highlight}</span>${tail}`;\r\n                    }                                        \r\n                }                \r\n                return `<li tabindex=${i}>${name}</li>`;               \r\n            }, []).join('') + '</ul>';\r\n\r\n            this._list.innerHTML = html;\r\n            let elements = this._list.querySelectorAll('li');\r\n            for (let i = 0; i < elements.length; ++i){\r\n                elements[i].addEventListener('click', this._handleClick.bind(this, i));            \r\n            }\r\n            \r\n            this.count = elements.length;\r\n            this._list.style.display = 'block';\r\n        }\r\n    }\r\n    hide() {        \r\n        this._list.style.display = 'none';                \r\n    }\r\n}\r\n\r\nexport { ResultView };\n\n\n// WEBPACK FOOTER //\n// ./E:/projects/Leaflet.ExtSearch/src/ResultView.js","\r\nclass OsmDataProvider {\r\n    constructor({serverBase, onFetch}){\r\n        this._serverBase = serverBase;\r\n        this._onFetch = onFetch;        \r\n        this.showSuggestion = true;    \r\n        this.showOnSelect = true;\r\n        this.showOnEnter = true;\r\n        this.find = this.find.bind(this);\r\n        this.fetch = this.fetch.bind(this);\r\n        this._convertGeometry = this._convertGeometry.bind(this);\r\n\r\n        this._key = window.KOSMOSNIMKI_SESSION_KEY == null || window.KOSMOSNIMKI_SESSION_KEY == 'INVALID' ? '' : `&key=${window.KOSMOSNIMKI_SESSION_KEY}`;\r\n    }\r\n    _convertGeometry(geometry) {        \r\n        switch (geometry.type.toUpperCase()) {\r\n            case 'POINT':\r\n                geometry.type = 'Point';\r\n                break;\r\n            case 'POLYGON':\r\n                geometry.type = 'Polygon';\r\n                break;\r\n            case 'MULTIPOLYGON':\r\n                geometry.type = 'MultiPolygon';\r\n                break;\r\n            case 'LINESTRING':\r\n            case 'POLYLINE':\r\n                geometry.type = 'LineString';\r\n                break;\r\n            case 'MULTILINESTRING':\r\n                geometry.type = 'MultiLineString';\r\n                break;\r\n            default:\r\n                throw 'Unknown WKT type';\r\n        }\r\n        return geometry;\r\n    }\r\n    fetch (obj) {\r\n        const query = `RequestType=ID&ID=${obj.ObjCode}&TypeCode=${obj.TypeCode}&UseOSM=1`;        \r\n        let req = new Request(`${this._serverBase}/SearchObject/SearchAddress.ashx?${query}${this._key}`);\r\n        let headers = new Headers();\r\n        headers.append('Content-Type','application/json');        \r\n        let init = {\r\n            method: 'GET',            \r\n            mode: 'cors',\r\n            credentials: 'include',        \r\n            cache: 'default',\r\n        };\r\n        return new Promise((resolve, reject) => {\r\n            fetch (req, init)\r\n            .then(response => response.text())\r\n            .then(response => {                \r\n                const json = JSON.parse (response.slice(1, response.length - 1));\r\n                if(json.Status === 'ok'){\r\n                    const rs = json.Result\r\n                    .reduce((a,x) => a.concat(x.SearchResult), [])\r\n                    .map(x => {\r\n                        let g = this._convertGeometry (x.Geometry);\r\n                        let props = Object.keys(x)\r\n                        .filter(k => k !== 'Geometry')\r\n                        .reduce((a,k) => {\r\n                            a[k] = x[k];\r\n                            return a;\r\n                        }, {});\r\n                        return {\r\n                            feature: {\r\n                                type: 'Feature',\r\n                                geometry: g,\r\n                                properties: props,                            \r\n                            },\r\n                            provider: this,\r\n                            query: obj,\r\n                        };\r\n                    });\r\n                    if (typeof this._onFetch === 'function'){\r\n                        this._onFetch(rs);\r\n                    }                \r\n                    resolve(rs);\r\n                }\r\n                else {\r\n                    reject(json);\r\n                }                \r\n            });\r\n        });\r\n    }\r\n    find(value, limit, strong, retrieveGeometry){\r\n        const _strong = Boolean(strong) ? 1 : 0;\r\n        const _withoutGeometry = Boolean(retrieveGeometry) ? 0 : 1; \r\n        const query = `WrapStyle=None&RequestType=SearchObject&IsStrongSearch=${_strong}&WithoutGeometry=${_withoutGeometry}&UseOSM=1&Limit=${limit}&SearchString=${encodeURIComponent(value)}`;        \r\n        let req = new Request(`${this._serverBase}/SearchObject/SearchAddress.ashx?${query}${this._key}`);\r\n        let headers = new Headers();\r\n        headers.append('Content-Type','application/json');        \r\n        let init = {\r\n            method: 'GET',\r\n            mode: 'cors', \r\n            credentials: 'include',\r\n            cache: 'default',\r\n        };\r\n        return new Promise((resolve, reject) => {\r\n            fetch (req, init)\r\n            .then(response => response.json())\r\n            .then(json => {                \r\n                if(json.Status === 'ok'){                    \r\n                    const rs = json.Result\r\n                    .reduce((a,x) => a.concat(x.SearchResult), [])\r\n                    .map(x => {\r\n                        if (retrieveGeometry) {\r\n                            let g = this._convertGeometry (x.Geometry);\r\n                            let props = Object.keys(x)\r\n                            .filter(k => k !== 'Geometry')\r\n                            .reduce((a,k) => {\r\n                                a[k] = x[k];\r\n                                return a;\r\n                            }, {});\r\n                            return {\r\n                                name: x.ObjNameShort,\r\n                                feature: {\r\n                                    type: 'Feature',\r\n                                    geometry: g,\r\n                                    properties: props,                            \r\n                                },\r\n                                properties: props,\r\n                                provider: this,\r\n                                query: value,\r\n                            };\r\n                        }\r\n                        else {\r\n                            return {\r\n                                name: x.ObjNameShort,\r\n                                properties: x,\r\n                                provider: this,\r\n                                query: value,\r\n                            };\r\n                        }                        \r\n                    });\r\n                    if (limit === 1 && strong && retrieveGeometry && typeof this._onFetch === 'function'){\r\n                        this._onFetch(rs);\r\n                    }\r\n                    resolve(rs);                    \r\n                }\r\n                else {\r\n                    reject(json);\r\n                }                \r\n            })\r\n            .catch(response => reject(response));\r\n        });\r\n    }\r\n}\r\n\r\nwindow.nsGmx = window.nsGmx || {};\r\nwindow.nsGmx.OsmDataProvider = OsmDataProvider;\r\n\r\nexport { OsmDataProvider };\n\n\n// WEBPACK FOOTER //\n// ./E:/projects/Leaflet.ExtSearch/src/DataProviders/OsmDataProvider.js","\r\nclass CoordinatesDataProvider {\r\n    constructor({onFetch}){\r\n        this._onFetch = onFetch;\r\n        this.showSuggestion = false;        \r\n        this.showOnSelect = false;\r\n        this.showOnEnter = true;\r\n        this.fetch = this.fetch.bind(this);\r\n        this.find = this.find.bind(this);        \r\n\r\n        this.rxF = new RegExp('^\\\\s*\\\\-?(\\\\d+(\\\\.\\\\d+)?)(\\\\s+[N|S])?(,\\\\s*|\\\\s+)\\\\-?(\\\\d+(\\\\.\\\\d+)?)(\\\\s+[E|W])?');\r\n        this.rxD = new RegExp('^\\\\s*(\\\\d{1,2})[\\\\s|\\\\u00b0](\\\\d{1,2})[\\\\s|\\\\u0027](\\\\d{1,2}\\\\.\\\\d+)\\\\u0022?(\\\\s+[N|S])?,?\\\\s+(\\\\d{1,2})[\\\\s|\\\\u00b0](\\\\d{1,2})[\\\\s|\\\\u0027](\\\\d{1,2}\\\\.\\\\d+)\\\\u0022?(\\\\s+[E|W])?');\r\n    }\r\n    _parseCoordinates(value) {\r\n        let m = this.rxD.exec(value);\r\n        if (Array.isArray(m) && m.length === 9) {\r\n            return this._parseDegrees ([m[1],m[2],m[3],m[5],m[6],m[7]].map(x => parseFloat(x)));\r\n        }\r\n        m = this.rxF.exec(value);\r\n        if (Array.isArray (m) && m.length === 8){\r\n            return {type: 'Point', coordinates: [\r\n                parseFloat(m[5]),\r\n                parseFloat(m[1])\r\n            ]};\r\n        }\r\n        \r\n        return null;               \r\n    }\r\n    _parseDegrees ([latDeg, latMin, latSec, lngDeg, lngMin, lngSec]) {    \r\n        return {type: 'Point', coordinates: [\r\n            lngDeg + lngMin / 60 + lngSec / 3600,\r\n            latDeg + latMin / 60 + latSec / 3600\r\n        ]};\r\n    }\r\n    fetch (value){\r\n        return new Promise(resolve => resolve([]));\r\n    }\r\n    find(value, limit, strong, retrieveGeometry){        \r\n        let g = this._parseCoordinates(value);        \r\n        return new Promise(resolve => {\r\n            let result = {feature: { type: 'Feature', geometry: g, properties: {} }, provider: this, query: value};\r\n            if (g && typeof this._onFetch === 'function'){\r\n                this._onFetch(result);\r\n            }             \r\n            resolve(g ? [result] : []);\r\n        });\r\n    }\r\n}\r\n\r\nwindow.nsGmx = window.nsGmx || {};\r\nwindow.nsGmx.CoordinatesDataProvider = CoordinatesDataProvider;\r\n\r\nexport { CoordinatesDataProvider };\n\n\n// WEBPACK FOOTER //\n// ./E:/projects/Leaflet.ExtSearch/src/DataProviders/CoordinatesDataProvider.js","class CadastreDataProvider {\r\n    constructor({serverBase, tolerance, onFetch}){\r\n        this._serverBase = serverBase;        \r\n        this._tolerance = tolerance;\r\n        this._onFetch = onFetch;\r\n        this.showSuggestion = true;\r\n        this.showOnSelect = false;\r\n        this.showOnEnter = true;\r\n        this._cadastreLayers = [\t\t\t\r\n\t\t\t{id: 1, title: 'Участок', \treg: /^\\d\\d:\\d+:\\d+:\\d+$/},\r\n\t\t\t{id: 2, title: 'Квартал',\treg: /^\\d\\d:\\d+:\\d+$/},\r\n\t\t\t{id: 3, title: 'Район', \treg: /^\\d\\d:\\d+$/},\r\n\t\t\t{id: 4, title: 'Округ', \treg: /^\\d\\d$/},\r\n            {id: 5, title: 'ОКС', \t\treg: /^\\d\\d:\\d+:\\d+:\\d+:\\d+$/},\r\n\t\t\t{id: 10, title: 'ЗОУИТ', \treg: /^\\d+\\.\\d+\\.\\d+/}\r\n\t\t\t// ,\r\n\t\t\t// {id: 7, title: 'Границы', \treg: /^\\w+$/},\r\n\t\t\t// {id: 6, title: 'Тер.зоны', \treg: /^\\w+$/},\r\n\t\t\t// {id: 12, title: 'Лес', \t\treg: /^\\w+$/},\r\n\t\t\t// {id: 13, title: 'Красные линии', \t\treg: /^\\w+$/},\r\n\t\t\t// {id: 15, title: 'СРЗУ', \treg: /^\\w+$/},\r\n\t\t\t// {id: 16, title: 'ОЭЗ', \t\treg: /^\\w+$/},\r\n\t\t\t// {id: 9, title: 'ГОК', \t\treg: /^\\w+$/},\r\n\t\t\t// {id: 10, title: 'ЗОУИТ', \treg: /^\\w+$/}\r\n\t\t\t// /[^\\d\\:]/g,\r\n\t\t\t// /\\d\\d:\\d+$/,\r\n\t\t\t// /\\d\\d:\\d+:\\d+$/,\r\n\t\t\t// /\\d\\d:\\d+:\\d+:\\d+$/\r\n\t\t];\r\n    }    \r\n    getCadastreLayer (str, type) {\r\n        str = str.trim();\r\n        for (var i = 0, len = this._cadastreLayers.length; i < len; i++) {\r\n            var it = this._cadastreLayers[i];\r\n            if (it.id === type) { return it; }\r\n            if (it.reg.exec(str)) { return it; }\r\n        }\r\n        return this._cadastreLayers[0];\r\n    }\r\n    find(value, limit, strong, retrieveGeometry){   \r\n        const cadastreLayer = this.getCadastreLayer(value);    \r\n        return new Promise(resolve => {\r\n            let req = new Request(`${this._serverBase}/typeahead?limit=${limit}&skip=0&text=${value}&type=${cadastreLayer.id}`);\r\n            let headers = new Headers();\r\n            headers.append('Content-Type','application/json');            \r\n            let init = {\r\n                method: 'GET',            \r\n                mode: 'cors',                \r\n                cache: 'default',\r\n            };\r\n            fetch (req, init)\r\n            .then(response => response.text())\r\n            .then(response => {\r\n                const json = JSON.parse (response); \r\n                // if(json.status === 200){\r\n                    let rs = json.results.map(x => {\r\n                        return {\r\n                            name: x.title,\r\n                            properties: x,\r\n                            provider: this,\r\n                            query: value,\r\n                        };\r\n                    });\r\n                    resolve(rs);\r\n                // }\r\n                // else {\r\n                    // resolve(json);\r\n                // }                                       \r\n                                    \r\n            });\r\n        });\r\n    }\r\n    fetch(obj) {        \r\n        const cadastreLayer = this.getCadastreLayer(obj.value);\r\n        return new Promise(resolve => {\r\n            if(cadastreLayer) {\r\n                let req = new Request(`${this._serverBase}/features/${cadastreLayer.id}?tolerance=${this._tolerance}&limit=1&text=${obj.value}`);\r\n                let headers = new Headers();\r\n                headers.append('Content-Type','application/json');\r\n                let init = {\r\n                    method: 'GET',            \r\n                    mode: 'cors',                    \r\n                    cache: 'default',\r\n                };\r\n                fetch (req, init)\r\n                .then(response => response.text())\r\n                .then(response => {\r\n                    const json = JSON.parse (response);\r\n                    if(json.status === 200){\r\n                        if (typeof this._onFetch === 'function'){\r\n                            this._onFetch(json);\r\n                        }\r\n                        let rs = json.features.map(x => {\r\n                            return {\r\n                                name: x.attrs.name || x.attrs.cn || x.attrs.id,\r\n                                properties: x,\r\n                                provider: this,\r\n                                query: obj,\r\n                            };\r\n                            \r\n                        });\r\n                        resolve(rs);\r\n\r\n                    }\r\n                    else {\r\n                        resolve(json);\r\n                    }                                        \r\n                });\r\n            }\r\n            else {\r\n                resolve([]);\r\n            }            \r\n        });\r\n    }\r\n}\r\n\r\nwindow.nsGmx = window.nsGmx || {};\r\nwindow.nsGmx.CadastreDataProvider = CadastreDataProvider;\r\n\r\nexport { CadastreDataProvider };\n\n\n// WEBPACK FOOTER //\n// ./E:/projects/Leaflet.ExtSearch/src/DataProviders/CadastreDataProvider.js"],"sourceRoot":""}