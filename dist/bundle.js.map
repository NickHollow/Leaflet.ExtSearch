{"version":3,"sources":["webpack:///webpack/bootstrap a4ff722f231434ea6b1d","webpack:///./src/SearchWidget.js","webpack:///./src/DataProviders/CadastreDataProvider.js","webpack:///./src/DataProviders/CoordinatesDataProvider.js","webpack:///./src/DataProviders/OsmDataProvider.js","webpack:///./src/SearchControl.js","webpack:///./init.js","webpack:///./src/ResultView.js","webpack:///./src/SearchWidget.css"],"names":["chain","tasks","state","reduce","prev","next","then","Promise","resolve","reject","SearchWidget","container","placeHolder","providers","suggestionTimeout","limit","fuzzySearchLimit","retrieveManyOnEnter","_container","_allowSuggestion","_providers","_suggestionTimeout","_limit","_fuzzySearchLimit","_retrieveManyOnEnter","classList","add","innerHTML","_input","querySelector","addEventListener","_handleChange","bind","_handleMouseMove","_button","_handleSearch","results","input","onSelect","_selectItem","onEnter","_search","text","allowNavigation","filter","provider","showSuggestion","map","completed","find","response","length","concat","catch","console","log","e","show","trim","value","_timer","setTimeout","clearTimeout","_suggest","hide","stopPropagation","showOnEnter","item","fetch","properties","placeholder","CadastreDataProvider","serverBase","tolerance","onFetch","_serverBase","_tolerance","_onFetch","showOnSelect","_cadastreLayers","id","title","reg","str","type","i","len","it","exec","strong","retrieveGeometry","cadastreLayer","getCadastreLayer","req","Request","headers","Headers","append","init","method","mode","cache","json","rs","features","name","x","attrs","cn","query","obj","status","window","nsGmx","CoordinatesDataProvider","rxF","RegExp","rxD","m","Array","isArray","_parseDegrees","parseFloat","coordinates","latDeg","latMin","latSec","lngDeg","lngMin","lngSec","g","_parseCoordinates","result","feature","geometry","OsmDataProvider","_convertGeometry","_key","KOSMOSNIMKI_SESSION_KEY","toUpperCase","ObjCode","TypeCode","credentials","Status","Result","a","SearchResult","Geometry","props","Object","keys","k","_strong","Boolean","_withoutGeometry","encodeURIComponent","ObjNameShort","SearchControl","L","Control","extend","includes","Mixin","Events","initialize","options","setOptions","onAdd","DomUtil","create","_widget","on","addTo","prototype","call","addBefore","parentNode","_parent","_map","_controlCorners","getPosition","childNodes","_id","insertBefore","setText","setPlaceHolder","ResultView","replaceInput","_onSelect","_onEnter","index","count","_item","_inputText","_replaceInput","_list","setAttribute","style","top","offsetTop","offsetHeight","left","offsetLeft","_handleKey","_handleInputClick","_handleFocus","_handleWheel","DomEvent","disableClickPropagation","disableScrollPropagation","parentElement","appendChild","el","removeClass","listVisible","keyCode","preventDefault","addClass","selectItem","focus","setSelectionRange","complete","display","_items","items","highlight","html","start","toLowerCase","indexOf","head","substr","tail","join","elements","querySelectorAll","_handleClick"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a4ff722f231434ea6b1d","import './SearchWidget.css';\nimport { ResultView } from './ResultView.js';\n\nfunction chain (tasks, state) {\n    return tasks.reduce(\n        (prev, next) => prev.then(next),\n        new Promise ((resolve, reject) => resolve (state))\n    );\n}\n\nclass SearchWidget {\n    constructor(container, {placeHolder, providers, suggestionTimeout = 1000, limit = 10, fuzzySearchLimit = 1000, retrieveManyOnEnter = false}){\n        this._container = container;\n        this._allowSuggestion = true;\n        this._providers = providers;\n        this._suggestionTimeout = suggestionTimeout;\n        this._limit = limit;\n        this._fuzzySearchLimit = fuzzySearchLimit;\n        this._retrieveManyOnEnter = retrieveManyOnEnter;\n\n        this._container.classList.add('leaflet-ext-search');\n        this._container.innerHTML = `<input type=\"text\" value=\"\" placeholder=\"${placeHolder}\" /><span class=\"leaflet-ext-search-button\"></span>`;\n        this._input = this._container.querySelector('input');\n        this._input.addEventListener('input', this._handleChange.bind(this));\n        this._input.addEventListener('mousemove', this._handleMouseMove.bind(this));\n        this._input.addEventListener('dragstart', this._handleMouseMove.bind(this));\n        this._input.addEventListener('drag', this._handleMouseMove.bind(this));\n\n        this._button = this._container.querySelector('.leaflet-ext-search-button');\n        this._button.addEventListener('click', this._handleSearch.bind(this));\n\n        this.results = new ResultView({\n            input: this._input,\n            onSelect: this._selectItem.bind(this),\n            onEnter: this._search.bind(this),\n        });\n\n        // map.on ('click', this.results.hide.bind(this.results));\n        // map.on ('dragstart', this.results.hide.bind(this.results));\n    }\n    _suggest (text){\n        this.results.allowNavigation = false;\n        let tasks =\n            this._providers\n            .filter (provider => provider.showSuggestion)\n            .map(provider => {\n                return state => {\n                    return new Promise(resolve => {\n                        if (state.completed) {\n                            resolve(state);\n                        }\n                        else {\n                            provider\n                            .find (text, this._limit, false, false)\n                            .then(response => {\n                                state.completed = response.length > 0;\n                                state.response = state.response.concat(response);\n                                resolve(state);\n                            })\n                            .catch(e => console.log(e));\n                        }\n                    });\n                };\n            });\n        chain (tasks, { completed: false, response: [] })\n        .then(state => {\n            this.results.show(state.response, text.trim());\n            this.results.allowNavigation = true;\n        });\n    }\n    _handleChange(e) {\n        if (this._input.value.length) {\n            if (this._allowSuggestion) {\n                this._allowSuggestion = false;\n                this._timer = setTimeout(() => {\n                    clearTimeout (this._timer);\n                    this._allowSuggestion = true;\n                    const text = this._input.value;\n                    this._suggest(text);\n                }, this._suggestionTimeout);\n            }\n        }\n        else {\n            this.results.hide();\n        }\n    }\n    _handleMouseMove(e){\n        e.stopPropagation();\n    }\n    _search (text) {\n        let tasks = this._providers\n            .filter (provider => provider.showOnEnter)\n            .map(provider => {\n                return state => {\n                    return new Promise(resolve => {\n                        if (state.completed) {\n                            resolve(state);\n                        }\n                        else {\n                            provider\n                            .find (text, this._retrieveManyOnEnter ? this._fuzzySearchLimit : 1, true, true)\n                            .then(response => {\n                                state.completed = response.length > 0;\n                                state.response = state.response.concat(response);\n                                resolve(state);\n                            });\n                        }\n                    });\n                };\n            });\n\n            chain (tasks, {completed: false, response: []})\n            .then(state => {\n                if(state.response.length > 0 && !this._retrieveManyOnEnter){\n                    let item = state.response[0];\n                    item.provider\n                    .fetch(item.properties)\n                    .then(response => {});\n                }\n            });\n\n            this.results && this.results.hide();\n    }\n    _selectItem (item){\n        return item.provider.fetch(item.properties);\n    }\n    _handleSearch (e) {\n         e.stopPropagation();\n         this._search (this._input.value);\n    }\n    setText (text) {\n        this._input.value = text;\n    }\n\n    setPlaceHolder (value) {\n        this._input.placeholder = value;\n    }\n}\n\nexport { SearchWidget };\n\n\n\n// WEBPACK FOOTER //\n// ./src/SearchWidget.js","class CadastreDataProvider {\n    constructor({serverBase, tolerance, onFetch}){\n        this._serverBase = serverBase;        \n        this._tolerance = tolerance;\n        this._onFetch = onFetch;\n        this.showSuggestion = true;\n        this.showOnSelect = false;\n        this.showOnEnter = true;\n        this._cadastreLayers = [\t\t\t\n\t\t\t{id: 1, title: 'Участок', \treg: /^\\d\\d:\\d+:\\d+:\\d+$/},\n\t\t\t{id: 2, title: 'Квартал',\treg: /^\\d\\d:\\d+:\\d+$/},\n\t\t\t{id: 3, title: 'Район', \treg: /^\\d\\d:\\d+$/},\n\t\t\t{id: 4, title: 'Округ', \treg: /^\\d\\d$/},\n            {id: 5, title: 'ОКС', \t\treg: /^\\d\\d:\\d+:\\d+:\\d+:\\d+$/},\n\t\t\t{id: 10, title: 'ЗОУИТ', \treg: /^\\d+\\.\\d+\\.\\d+/}\n\t\t\t// ,\n\t\t\t// {id: 7, title: 'Границы', \treg: /^\\w+$/},\n\t\t\t// {id: 6, title: 'Тер.зоны', \treg: /^\\w+$/},\n\t\t\t// {id: 12, title: 'Лес', \t\treg: /^\\w+$/},\n\t\t\t// {id: 13, title: 'Красные линии', \t\treg: /^\\w+$/},\n\t\t\t// {id: 15, title: 'СРЗУ', \treg: /^\\w+$/},\n\t\t\t// {id: 16, title: 'ОЭЗ', \t\treg: /^\\w+$/},\n\t\t\t// {id: 9, title: 'ГОК', \t\treg: /^\\w+$/},\n\t\t\t// {id: 10, title: 'ЗОУИТ', \treg: /^\\w+$/}\n\t\t\t// /[^\\d\\:]/g,\n\t\t\t// /\\d\\d:\\d+$/,\n\t\t\t// /\\d\\d:\\d+:\\d+$/,\n\t\t\t// /\\d\\d:\\d+:\\d+:\\d+$/\n\t\t];\n    }    \n    getCadastreLayer (str, type) {\n        str = str.trim();\n        for (var i = 0, len = this._cadastreLayers.length; i < len; i++) {\n            var it = this._cadastreLayers[i];\n            if (it.id === type) { return it; }\n            if (it.reg.exec(str)) { return it; }\n        }\n        return this._cadastreLayers[0];\n    }\n    find(value, limit, strong, retrieveGeometry){   \n        const cadastreLayer = this.getCadastreLayer(value);    \n        return new Promise(resolve => {\n            // let req = new Request(`${this._serverBase}/typeahead?limit=${limit}&skip=0&text=${value}&type=${cadastreLayer.id}`);\n            let req = new Request(`${this._serverBase}/features/${cadastreLayer.id}?text=${value}&tolerance=${this._tolerance}&limit=${limit}`);\n            let headers = new Headers();\n            headers.append('Content-Type','application/json');            \n            let init = {\n                method: 'GET',            \n                mode: 'cors',                \n                cache: 'default',\n            };\n            fetch (req, init)\n            .then(response => response.json())\n            .then(json => {\n                // if(json.status === 200){\n                    let rs = json.features.map(x => {\n                        return {\n                            name: x.attrs.name || x.attrs.cn || x.attrs.id,\n                            properties: x,\n                            provider: this,\n                            query: value,\n                        };\n                    });\n                    resolve(rs);\n                // }\n                // else {\n                    // resolve(json);\n                // }                                       \n                                    \n            });\n        });\n    }\n    fetch(obj) {\n\t\tvar text = obj.attrs.name || obj.attrs.cn || obj.attrs.id;\n        const cadastreLayer = this.getCadastreLayer(text, obj.type);\n        return new Promise(resolve => {\n            if(cadastreLayer) {\n                // let req = new Request(`${this._serverBase}/features/${cadastreLayer.id}?tolerance=${this._tolerance}&limit=1&text=${obj.value}`);\n                let req = new Request(`${this._serverBase}/features/${cadastreLayer.id}?tolerance=${this._tolerance}&limit=1&text=${text}`);\n                let headers = new Headers();\n                headers.append('Content-Type','application/json');\n                let init = {\n                    method: 'GET',            \n                    mode: 'cors',                    \n                    cache: 'default',\n                };\n                fetch (req, init)\n                .then(response => response.json())\n                .then(json => {\n                    if(json.status === 200){\n                        if (typeof this._onFetch === 'function'){\n                            this._onFetch(json);\n                        }\n                        let rs = json.features.map(x => {\n                            return {\n                                name: x.attrs.name || x.attrs.cn || x.attrs.id,\n                                properties: x,\n                                provider: this,\n                                query: obj,\n                            };\n                            \n                        });\n                        resolve(rs);\n\n                    }\n                    else {\n                        resolve(json);\n                    }                                        \n                });\n            }\n            else {\n                resolve([]);\n            }            \n        });\n    }\n}\n\nwindow.nsGmx = window.nsGmx || {};\nwindow.nsGmx.CadastreDataProvider = CadastreDataProvider;\n\nexport { CadastreDataProvider };\n\n\n// WEBPACK FOOTER //\n// ./src/DataProviders/CadastreDataProvider.js","\nclass CoordinatesDataProvider {\n    constructor({onFetch}){\n        this._onFetch = onFetch;\n        this.showSuggestion = false;        \n        this.showOnSelect = false;\n        this.showOnEnter = true;\n        this.fetch = this.fetch.bind(this);\n        this.find = this.find.bind(this);        \n\n        this.rxF = new RegExp('^\\\\s*\\\\-?(\\\\d+(\\\\.\\\\d+)?)(\\\\s+[N|S])?(,\\\\s*|\\\\s+)\\\\-?(\\\\d+(\\\\.\\\\d+)?)(\\\\s+[E|W])?');\n        this.rxD = new RegExp('^\\\\s*(\\\\d{1,2})[\\\\s|\\\\u00b0](\\\\d{1,2})[\\\\s|\\\\u0027](\\\\d{1,2}\\\\.\\\\d+)\\\\u0022?(\\\\s+[N|S])?,?\\\\s+(\\\\d{1,2})[\\\\s|\\\\u00b0](\\\\d{1,2})[\\\\s|\\\\u0027](\\\\d{1,2}\\\\.\\\\d+)\\\\u0022?(\\\\s+[E|W])?');\n    }\n    _parseCoordinates(value) {\n        let m = this.rxD.exec(value);\n        if (Array.isArray(m) && m.length === 9) {\n            return this._parseDegrees ([m[1],m[2],m[3],m[5],m[6],m[7]].map(x => parseFloat(x)));\n        }\n        m = this.rxF.exec(value);\n        if (Array.isArray (m) && m.length === 8){\n            return {type: 'Point', coordinates: [\n                parseFloat(m[5]),\n                parseFloat(m[1])\n            ]};\n        }\n        \n        return null;               \n    }\n    _parseDegrees ([latDeg, latMin, latSec, lngDeg, lngMin, lngSec]) {    \n        return {type: 'Point', coordinates: [\n            lngDeg + lngMin / 60 + lngSec / 3600,\n            latDeg + latMin / 60 + latSec / 3600\n        ]};\n    }\n    fetch (value){\n        return new Promise(resolve => resolve([]));\n    }\n    find(value, limit, strong, retrieveGeometry){        \n        let g = this._parseCoordinates(value);        \n        return new Promise(resolve => {\n            let result = {feature: { type: 'Feature', geometry: g, properties: {} }, provider: this, query: value};\n            if (g && typeof this._onFetch === 'function'){\n                this._onFetch(result);\n            }             \n            resolve(g ? [result] : []);\n        });\n    }\n}\n\nwindow.nsGmx = window.nsGmx || {};\nwindow.nsGmx.CoordinatesDataProvider = CoordinatesDataProvider;\n\nexport { CoordinatesDataProvider };\n\n\n// WEBPACK FOOTER //\n// ./src/DataProviders/CoordinatesDataProvider.js","\nclass OsmDataProvider {\n    constructor({serverBase, onFetch}){\n        this._serverBase = serverBase;\n        this._onFetch = onFetch;        \n        this.showSuggestion = true;    \n        this.showOnSelect = true;\n        this.showOnEnter = true;\n        this.find = this.find.bind(this);\n        this.fetch = this.fetch.bind(this);\n        this._convertGeometry = this._convertGeometry.bind(this);\n\n        this._key = window.KOSMOSNIMKI_SESSION_KEY == null || window.KOSMOSNIMKI_SESSION_KEY == 'INVALID' ? '' : `&key=${window.KOSMOSNIMKI_SESSION_KEY}`;\n    }\n    _convertGeometry(geometry) {        \n        switch (geometry.type.toUpperCase()) {\n            case 'POINT':\n                geometry.type = 'Point';\n                break;\n            case 'POLYGON':\n                geometry.type = 'Polygon';\n                break;\n            case 'MULTIPOLYGON':\n                geometry.type = 'MultiPolygon';\n                break;\n            case 'LINESTRING':\n            case 'POLYLINE':\n                geometry.type = 'LineString';\n                break;\n            case 'MULTILINESTRING':\n                geometry.type = 'MultiLineString';\n                break;\n            default:\n                throw 'Unknown WKT type';\n        }\n        return geometry;\n    }\n    fetch (obj) {\n        const query = `WrapStyle=None&RequestType=ID&ID=${obj.ObjCode}&TypeCode=${obj.TypeCode}&UseOSM=1`;        \n        let req = new Request(`${this._serverBase}/SearchObject/SearchAddress.ashx?${query}${this._key}`);\n        let headers = new Headers();\n        headers.append('Content-Type','application/json');        \n        let init = {\n            method: 'GET',            \n            mode: 'cors',\n            credentials: 'include',        \n            cache: 'default',\n        };\n        return new Promise((resolve, reject) => {\n            fetch (req, init)\n            .then(response => response.json())\n            .then(json => {\n                if(json.Status === 'ok'){\n                    const rs = json.Result\n                    .reduce((a,x) => a.concat(x.SearchResult), [])\n                    .map(x => {\n                        let g = this._convertGeometry (x.Geometry);\n                        let props = Object.keys(x)\n                        .filter(k => k !== 'Geometry')\n                        .reduce((a,k) => {\n                            a[k] = x[k];\n                            return a;\n                        }, {});\n                        return {\n                            feature: {\n                                type: 'Feature',\n                                geometry: g,\n                                properties: props,                            \n                            },\n                            provider: this,\n                            query: obj,\n                        };\n                    });\n                    if (typeof this._onFetch === 'function'){\n                        this._onFetch(rs);\n                    }                \n                    resolve(rs);\n                }\n                else {\n                    reject(json);\n                }                \n            })\n            .catch(response => reject(response));\n        });\n    }\n    find(value, limit, strong, retrieveGeometry){\n        const _strong = Boolean(strong) ? 1 : 0;\n        const _withoutGeometry = Boolean(retrieveGeometry) ? 0 : 1; \n        const query = `WrapStyle=None&RequestType=SearchObject&IsStrongSearch=${_strong}&WithoutGeometry=${_withoutGeometry}&UseOSM=1&Limit=${limit}&SearchString=${encodeURIComponent(value)}`;        \n        let req = new Request(`${this._serverBase}/SearchObject/SearchAddress.ashx?${query}${this._key}`);\n        let headers = new Headers();\n        headers.append('Content-Type','application/json');        \n        let init = {\n            method: 'GET',\n            mode: 'cors', \n            credentials: 'include',\n            cache: 'default',\n        };\n        return new Promise((resolve, reject) => {\n            fetch (req, init)\n            .then(response => response.json())\n            .then(json => {                \n                if(json.Status === 'ok'){                    \n                    const rs = json.Result\n                    .reduce((a,x) => a.concat(x.SearchResult), [])\n                    .map(x => {\n                        if (retrieveGeometry && x.Geometry) {\n                            let g = this._convertGeometry (x.Geometry);\n                            let props = Object.keys(x)\n                            .filter(k => k !== 'Geometry')\n                            .reduce((a,k) => {\n                                a[k] = x[k];\n                                return a;\n                            }, {});\n                            return {\n                                name: x.ObjNameShort,\n                                feature: {\n                                    type: 'Feature',\n                                    geometry: g,\n                                    properties: props,                            \n                                },\n                                properties: props,\n                                provider: this,\n                                query: value,\n                            };\n                        }\n                        else {\n                            return {\n                                name: x.ObjNameShort,\n                                properties: x,\n                                provider: this,\n                                query: value,\n                            };\n                        }                        \n                    });\n                    if (typeof this._onFetch === 'function' && strong && retrieveGeometry) {\n                        this._onFetch(rs);\n                    }\n                    resolve(rs);                    \n                }\n                else {\n                    reject(json);\n                }                \n            })\n            .catch(response => reject(response));\n        });\n    }\n}\n\nwindow.nsGmx = window.nsGmx || {};\nwindow.nsGmx.OsmDataProvider = OsmDataProvider;\n\nexport { OsmDataProvider };\n\n\n// WEBPACK FOOTER //\n// ./src/DataProviders/OsmDataProvider.js","import { SearchWidget } from './SearchWidget.js';\n\nlet SearchControl = L.Control.extend({\n    includes: [L.Mixin.Events],\n    initialize: function(options) {\n        L.setOptions(this, options);\n        this._allowSuggestion = true;\n        this.options.suggestionTimeout = this.options.suggestionTimeout || 1000;\n        this.options.limit = this.options.limit || 10;\n    },\n    onAdd: function(map) {\n        this._container = L.DomUtil.create('div', 'leaflet-ext-search');\n        this._widget = new SearchWidget(this._container, this.options);\n        map.on('click', this._widget.results.hide.bind(this._widget.results));\n        map.on('dragstart', this._widget.results.hide.bind(this._widget.results));\n        return this._container;\n    },\n    addTo: function(map) {\n        L.Control.prototype.addTo.call(this, map);\n        if (this.options.addBefore) {\n            this.addBefore(this.options.addBefore);\n        }\n        return this;\n    },\n\n    addBefore: function(id) {\n        let parentNode = this._parent && this._parent._container;\n        if (!parentNode) {\n            parentNode = this._map && this._map._controlCorners[this.getPosition()];\n        }\n        if (!parentNode) {\n            this.options.addBefore = id;\n        }\n        else {\n            for (let i = 0, len = parentNode.childNodes.length; i < len; i++) {\n                let it = parentNode.childNodes[i];\n                if (id === it._id) {\n                    parentNode.insertBefore(this._container, it);\n                    break;\n                }\n            }\n        }\n        return this;\n    },\n\n    setText (text) {\n        this._widget.setText (text);\n    },\n\n    setPlaceHolder (value) {\n        this._widget.setPlaceHolder (value);\n    },\n});\n\nexport { SearchControl };\n\n\n\n// WEBPACK FOOTER //\n// ./src/SearchControl.js","import { SearchWidget } from './src/SearchWidget.js';\nimport { SearchControl } from './src/SearchControl.js';\nimport { OsmDataProvider } from './src/DataProviders/OsmDataProvider.js';\nimport { CoordinatesDataProvider } from './src/DataProviders/CoordinatesDataProvider.js';\nimport { CadastreDataProvider } from './src/DataProviders/CadastreDataProvider.js';\n\nwindow.nsGmx = window.nsGmx || {};\nwindow.nsGmx.SearchWidget = SearchWidget;\nwindow.nsGmx.SearchControl = SearchControl;\nwindow.nsGmx.OsmDataProvider = OsmDataProvider;\nwindow.nsGmx.CoordinatesDataProvider = CoordinatesDataProvider;\nwindow.nsGmx.CadastreDataProvider = CadastreDataProvider;\n\n\n// WEBPACK FOOTER //\n// ./init.js","class ResultView {\n    constructor({input, onSelect, onEnter, replaceInput = false}){\n        this._input = input;\n        this._onSelect = onSelect;\n        this._onEnter = onEnter;\n        this.index = -1;\n        this.count = 0;\n        this._item = null;\n        this._inputText = '';\n        this._replaceInput = replaceInput;\n        this._list = L.DomUtil.create('div');\n        this._list.setAttribute('class', 'leaflet-ext-search-list noselect');\n\n        this.allowNavigation = true;\n\n        this._list.style.top = `${this._input.offsetTop + this._input.offsetHeight + 2}px`;\n        this._list.style.left = `${this._input.offsetLeft}px`;\n        this._input.addEventListener('keydown', this._handleKey.bind(this));\n        this._input.addEventListener('click', this._handleInputClick.bind(this));\n        this._input.addEventListener('focus', this._handleFocus.bind(this));\n        this._list.addEventListener('keydown', this._handleKey.bind(this));\n        this._list.addEventListener('wheel', this._handleWheel.bind(this));\n        L.DomEvent.disableClickPropagation(this._list).disableScrollPropagation(this._list);\n        // this._list.addEventListener('mousewheel', this._handleWheel.bind(this));\n        // this._list.addEventListener('MozMousePixelScroll', this._handleWheel.bind(this));       \n        this._input.parentElement.appendChild(this._list); \n        this._input.addEventListener('input', this._handleChange.bind(this));\n    }\n\n    _handleInputClick (e) {\n        e.stopPropagation();\n    }\n\n    _handleFocus(e){        \n        if(this.index >= 0) {\n            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`); \n            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\n        }\n        this.index = -1;\n        this._item = null;\n    } \n\n    _handleChange(e){\n        this._inputText = this._input.value;\n    }\n\n    _handleWheel (e) {\n        e.stopPropagation();        \n    } \n\n    _handleKey(e){        \n        if(this.listVisible()) {\n            switch (e.keyCode){\n                // ArroLeft / ArrowRight\n                case 37:\n                case 39:\n                    e.stopPropagation();\n                    break;\n                // ArrowDown\n                case 40:\n                    e.preventDefault();\n                    e.stopPropagation();                 \n                    if (this.allowNavigation) {                        \n                        if (this.index < 0){\n                            this.index = 0;\n                        }\n                        else if (0 <= this.index && this.index < this.count - 1){\n                            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\n                            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\n                            ++this.index;\n                        }   \n                        else {\n                            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\n                            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\n                            this.index = this.count - 1;\n                        }\n                        let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\n                        L.DomUtil.addClass (el, 'leaflet-ext-search-list-selected'); \n                        this.selectItem(this.index);\n                        el.focus();\n                    }\n                    break;\n                // ArrowUp\n                case 38:\n                    e.preventDefault(); \n                    e.stopPropagation(); \n                    if (this.allowNavigation) {\n                        if(this.index > 0){\n                            let el = this._list.querySelector(`[tabindex=\"${this.index}\"]`); \n                            L.DomUtil.removeClass (el, 'leaflet-ext-search-list-selected');\n                            --this.index;\n                            el = this._list.querySelector(`[tabindex=\"${this.index}\"]`);\n                            L.DomUtil.addClass (el, 'leaflet-ext-search-list-selected');\n                            this.selectItem(this.index);\n                            el.focus();            \n                        }\n                        else if (this.index === 0) {                    \n                            this._input.focus();                \n                            this._input.value = this._inputText;                    \n                        }\n                    }\n                    break;\n                // Enter\n                case 13:\n                    if (this.index < 0 && this._input.value && typeof this._onEnter === 'function'){\n                        const text = this._input.value;\n                        this._input.focus();\n                        this._input.setSelectionRange(text.length, text.length);                                      \n                        this.hide();                        \n                        this._onEnter (text);\n                    }\n                    else {\n                        this.complete (this.index);\n                    }                   \n                    break;\n                // Escape\n                case 27:\n                    if (this.index < 0) {\n                        this.hide ();\n                    }\n                    this._input.focus();\n                    this._input.value = this._inputText;\n                    break;                 \n                default:\n                    break;\n            }            \n        }\n        else {            \n            if (e.keyCode === 13 && this._input.value && typeof this._onEnter == 'function'){ \n                const text = this._input.value;\n                this._input.setSelectionRange(text.length, text.length);\n                this._onEnter (text);\n            }\n            else if (e.keyCode === 27){\n                this._input.value = '';\n                this.index = -1;\n                this._input.focus();                \n            }\n        } \n                                                                    \n    }\n\n    listVisible(){\n        return this.count > 0 && this._list.style.display !== 'none';\n    }\n\n    selectItem(i){        \n        this._item = this._items[i];        \n        const text = this._item.name;\n        if (this._replaceInput) {\n            this._input.value = text;            \n            this._input.setSelectionRange(text.length, text.length);\n        }        \n    }\n\n    _handleClick (i, e){\n        e.preventDefault();\n        this.complete (i);\n    }\n\n    complete(i){\n        let item = i >= 0 ? this._items[i] : this._item ? this._item : null;\n        if(item) {\n            this._item = item;        \n            this.index = -1;            \n            const text = item.name;\n            if (this._replaceInput) {\n                this._input.value = text;\n                this._input.setSelectionRange(text.length, text.length);\n            }\n            this._input.focus();\n            this.hide();\n            if(typeof this._onSelect === 'function'){\n                this._onSelect (item);\n            }\n        }        \n    }\n\n    show(items, highlight) {        \n        if (items.length) {\n            this._item = null;\n            this.index = -1;\n            this._items = items;\n            const html = '<ul>' + this._items\n            .filter((x) => x.name && x.name.length)\n            .map((x,i) => {\n                let name = `<span class=\"leaflet-ext-search-list-item-normal\">${x.name}</span>`;\n                if (highlight && highlight.length){\n                    const start = x.name.toLowerCase().indexOf (highlight.toLowerCase());\n                    if (start != -1) {\n                        let head =  x.name.substr(0, start);\n                        if(head.length){\n                            head = `<span class=\"leaflet-ext-search-list-item-normal\">${head}</span>`;\n                        }                        \n                        let tail = x.name.substr(start + highlight.length);\n                        if(tail.length){\n                            tail = `<span class=\"leaflet-ext-search-list-item-normal\">${tail}</span>`;\n                        }\n                        name = `${head}<span class=\"leaflet-ext-search-list-item-highlight\">${highlight}</span>${tail}`;\n                    }                                        \n                }                \n                return `<li tabindex=${i}>${name}</li>`;               \n            }, []).join('') + '</ul>';\n\n            this._list.innerHTML = html;\n            let elements = this._list.querySelectorAll('li');\n            for (let i = 0; i < elements.length; ++i){\n                elements[i].addEventListener('click', this._handleClick.bind(this, i));            \n            }\n            \n            this.count = elements.length;\n            this._list.style.display = 'block';\n        }\n    }\n    hide() {        \n        this._list.style.display = 'none';                \n    }\n}\n\nexport { ResultView };\n\n\n// WEBPACK FOOTER //\n// ./src/ResultView.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/SearchWidget.css\n// module id = 7\n// module chunks = 0"],"sourceRoot":""}