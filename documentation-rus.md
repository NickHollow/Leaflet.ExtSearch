### Плагин контрола поиска

### nsGmx.SearchControl
Позволяет производить поиск объектов и размещать их на карте. Расширяет [L.Control](http://leafletjs.com/reference.html#control).

#### Создание

| Создание | Описание |
|---------|:---------|
| nsGmx.SearchControl (`<Options>` options?) | Создание контрола поиска |

#### Oпции

| Свойство | Тип | По умолчанию | Описание |
|----------|:---:|:------------:|:---------|
| id | String | search | Идентификатор контрола. |
|position | String | `topright` | Положение контрола в одном из углов карты (`topleft`, `topright`, `bottomleft` или `bottomright`) |
| placeHolder | String | Поиск по кадастру, адресам, координатам | Подсказка поля ввода поисковой строки. |
| limit | Int | 10 | Ограничение количества выводимых объектов. |
| providers | массив объектов типа [`Provider`](#pr) | [] | Список поставщиков данных для поиска ([CoordinatesDataProvider](#CoordinatesDataProvider), [OsmDataProvider](#OsmDataProvider)). |  
<br/>

#### Методы

#### setPlaceholder

`nsGmx.SearchControl.setPlaceholder (Value)`

| Параметр | Возвращает | Тип данных | Описание |  
|----------|:----------:|:-----------|----------|
| Value | - | String | Ввод текста в поле поисковой строки |
<br/>

#### setText

`nsGmx.SearchControl.setText (value)` - заменяет  содержимое строки поиска.

| Параметр | Возвращает | Тип данных | Описание |  
|----------|:----------:|:-----------|----------|
| Value | - | String | Установка значения поля ввода поисковой строки. |
<br/>

### nsGmx.SearchWidget

#### Создание

`new nsGmx.SearchWidget(container, <Options> options)`

#### Опции

| Свойство | Тип | По умолчанию | Описание |
|----------|-----|:-------------|:---------|
| placeHolder | String | Поиск по кадастру, адресам, координатам | Подсказка поля ввода поисковой строки. |
| providers | массив объектов типа [`Provider`](#pr) | [] | Список поставщиков данных для поиска ([CoordinatesDataProvider](#CoordinatesDataProvider), [OsmDataProvider](#OsmDataProvider)). |
| suggestionTimeout | Int | 1000 | Задержка вывода списка при вводе поисковой строки в миллисекундах |
| fuzzySearchLimit | Int | 1000 | Ограничение количества возвращаемых результатов при нечетком поиске |
| retrieveManyOnEnter | Bool | false | Считать нажатие "Enter" командой поиска |
| replaceInputOnEnter  | Bool | false | Заменять содержимое строки поиска описанием найденного объекта |
<br/>

#### События

`nsGmx.SearchWidget`

| Имя | Тип | Описание |
| --- | -------- |:---------|
| `suggestions:confirm` | Event | Срабатывает при нажатии пользователем "Enter" в строке поиска. |

#### Event

| Свойство | Описание |
| -------- |:---------|
| `detail` | Текущий текст в строке поиска |



`SearchControl` и `SearchWidget` - объекты одного иерархического уровня. Но `SearchWidget` в отличие от `SearchControl` не наследует никаких свойств и может быть помещен в отдельный контейнер.

<br/>

### <a name="pr">`Провайдеры`</a>

Это интерфейс, который должен обладать следующими свойствами.

#### Опции поискового провайдера

| Свойство | Тип | По умолчанию | Описание |
|----------|-----|:------------:|:---------|
| showOnEnter| Bool | false | Поиск объекта, который показывается на карте |
| showSuggestion | Bool | false | Показывать список подсказок |
| showOnSelect | Bool | false | Показывать объект при выделении в списке |

Возможно подключение следующих провайдеров: [CoordinatesDataProvider](#CoordinatesDataProvider), [OsmDataProvider](#OsmDataProvider).

<br/>
#### CoordinatesDataProvider


`new nsGmx.CoordinatesDataProvider ()` - создание провайдера поиска по координатам.

<br/>

#### OsmDataProvider

`new nsGmx.SearchControl.OsmDataProvider (serverBase)` - создание поискового провайдера OSM.
<br/>

#### События поискового провайдера OSM


| Имя | Тип | Описание |
| --- | --- |:---------|
| fetch  | Event | Сообщение провайдером результата поискового запроса пользователя |

### Event

| Свойство | Описание |
| --- | -------- |
| detail  | Массив найденных провайдером  объектов  |


| Параметр | Описание |
| -------- | -------- |
| feature |  Метаданные найденного объекта в формате GeoJSON |
| provider | Ссылка на провайдер `(nsGmx.SearchControl.OsmDataProvide)` |
| query | Поисковый объект |
<br/>

#### Методы

#### Find
`nsGmx.SearchControl.Provider.find(value, limit, strong, retrieveGeometry)` - выполняет поиск введённых в строку объектов.

| Параметр | Возвращает | Тип данных | Описание | Значение по умолчанию |
|----------|------------|------------|:---------|-----------------------|
| value | `this` | String | Поисковая строка | [] |
| limit | `this` | Int | Количество элементов, возвращаемых провайдером при поиске | 10 |
| strong | `this` | Bool | Строгий поиск объектов | false |
| retrieveGeometry | `this` | Bool | Возвращает геометрию объектов | false |

#### Fetch
`nsGmx.SearchControl.Provider.fetch (obj)` - возвращает искомый объект со всеми метаданными.

| Параметр | Возвращает | Тип данных | Описание | Значение по умолчанию |
|----------|------------|------------|:---------|-----------------------|
| obj | `this` | Object | Объект поиска | Null |

Имеется возможность реализовать собственный провайдер, указав соответствующие методы (`Find` и `Fetch`). Крайне важен порядок поиска по провайдерам. Поиск выполянется последовательно по приоритету. В случае если первым провайдером получен результат, следующий уже не вызывается.
